{
    "version": "https://jsonfeed.org/version/1",
    "title": "自是白衣卿相的博客",
    "subtitle": null,
    "icon": "http://example.com/images/favicon.ico",
    "description": null,
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/projects/alzheimer/",
            "url": "http://example.com/projects/alzheimer/",
            "title": "Alzheimer’s Disease Detection using Disfluencies Implemented Fine-Tuning BERT Model Ensemble",
            "date_published": "2024-02-23T16:00:00.000Z",
            "content_html": "<ol>\n<li>背景介绍<br>\n使用原始的、未注释的、未转录的语音进行目标认知状态预测，并解决认知随时间变化的预测。</li>\n</ol>\n<p>address 挑战：阿尔茨海默氏痴呆症识别仅通过自发语言</p>\n<ul>\n<li>从一个简短的演讲中检测阿尔茨海默氏痴呆症</li>\n<li>认知测试分数的推断，MMSE 分数。</li>\n<li>预测认知能力下降</li>\n</ul>\n<p>任务:<br>\n 从一个简短的演讲中检测阿尔茨海默氏痴呆症</p>\n<p>可能的一般方法:</p>\n<ul>\n<li>直接使用语音信号 (声学特征)</li>\n<li>语音自动转换为文本 (ASR)，并从脚本中提取语言特征</li>\n</ul>\n<p>更好的解决方案:<br>\n 结合声学和语言特征，利用预训练 BERT 模型。</p>\n",
            "tags": [
                "科研项目",
                "自然语言处理"
            ]
        },
        {
            "id": "http://example.com/travel/japan/food/",
            "url": "http://example.com/travel/japan/food/",
            "title": "日本行美食总结",
            "date_published": "2024-02-03T16:00:00.000Z",
            "content_html": "<h1 id=\"神户\"><a class=\"anchor\" href=\"#神户\">#</a> 神户</h1>\n<h2 id=\"くつろぎ家kutsurogiya\"><a class=\"anchor\" href=\"#くつろぎ家kutsurogiya\">#</a> くつろぎ家（Kutsurogiya）</h2>\n<p>网红的平价米其林（2016 年米其林推荐），招牌釜饭确实好吃 <strong>『くつろぎ釜飯』</strong>，内涵鲷鱼鲑鱼章鱼及蔬菜，味道很有层次。网红的蒸和牛 **『湯けむり蒸し』** 是牛肉与蔬菜在小蒸笼里现场蒸制，本身没有调味，即便有酱料蘸碟还是觉得乏善可陈。当地人基本都只点釜饭，点和牛的都是游客。有小碟点心小菜，杏仁豆腐什么的。冬季限定有牡蛎釜饭。</p>\n<p>有馬温泉駅 徒歩 5 分 日式榻榻米风格餐厅</p>\n<p>不支持预定，仅能 walk-in 排队，cash only，人均 200+RMB</p>\n<h2 id=\"神戸豚骨ラーメン-賀正軒gashoken\"><a class=\"anchor\" href=\"#神戸豚骨ラーメン-賀正軒gashoken\">#</a> 神戸豚骨ラーメン 賀正軒（Gashoken）</h2>\n<p>除了传统的豚骨拉面外 <strong>『白賀正』</strong>，还有罗勒调味的 <strong>『翠賀正』</strong>、黑蒜墨鱼汁调味的 <strong>『黑賀正』</strong> 和辣味的 <strong>『赤賀正』</strong>，面里加水饺，大海苔，汤底偏咸。</p>\n<p>三宫站附近 日式居酒屋风格餐厅</p>\n<p>有点餐机 可中文 多种支付方式</p>\n<h1 id=\"大阪\"><a class=\"anchor\" href=\"#大阪\">#</a> 大阪</h1>\n<h2 id=\"北極星-心齋橋本店\"><a class=\"anchor\" href=\"#北極星-心齋橋本店\">#</a> 北極星 心齋橋本店</h2>\n<p>百年历史老店，可选鸡肉 / 火腿 / 蘑菇 / 牛肉 / 蟹肉<strong>蛋包饭</strong>，辅以番茄酱汁（好像也有咖喱酱），可选 Topping 配菜炸物。是一份品质很不错的蛋包饭，但也仅此而已了。</p>\n<p>不支持预定，门口 iPad 上取号后排队，日式居榻榻米风格餐厅</p>\n<p>有中文菜单，支持信用卡支付</p>\n<h2 id=\"お好み鉄板酒場-どら十doraju\"><a class=\"anchor\" href=\"#お好み鉄板酒場-どら十doraju\">#</a> お好み鉄板酒場 どら十（Doraju）</h2>\n<p>小巷子里的热门<strong>大阪烧</strong>小作坊，仅有两名店员，样本观察顾客中国人居多，看不懂菜单的都点 MIX 大阪烧。也有蛋包饭、炒面、和牛、炸物烤物小吃等。入座必须要点一杯饮料。大阪烧做的确实不错，可选内料，表皮非常酥脆，内馅绵软柔密</p>\n<p>心斎橋駅 徒歩 3 分 日式居酒屋风格餐厅 座位少</p>\n<p>可在线预约 日文菜单 支持插入式信用卡</p>\n<h2 id=\"銀座-篝拉麵-lucua大阪店\"><a class=\"anchor\" href=\"#銀座-篝拉麵-lucua大阪店\">#</a> 銀座 篝拉麵 LUCUA 大阪店</h2>\n<p>16、17 年的米其林推荐的网红<strong>拉面</strong>，招牌鸡白汤拉面和花蛤牡蛎海鲜拉面。海鲜汤底有点鲜过头了，花蛤可能是熬汤后的产品，所以本身没有什么味道，牡蛎干货味道重，不是特别适合作为配菜。面条没有煮的很入味，面粉味还是非常明显的。Topping 是低温慢煮的鸡肉和猪肉，个人认为鸡肉没有处理的特别好，猪肉比较好吃。小碟是柚子皮和炸洋葱。总体而言除了汤底鲜甜，其他并不是很配得上他的价格和排队时间。</p>\n<p>大阪梅田 LUCUA 地下一层，排队久</p>\n<p>有中英文菜单，可使用信用卡和 suica</p>\n<h1 id=\"京都\"><a class=\"anchor\" href=\"#京都\">#</a> 京都</h1>\n<h2 id=\"やきとり大吉-堀川高辻店daikichi-horikawa-takatsuji\"><a class=\"anchor\" href=\"#やきとり大吉-堀川高辻店daikichi-horikawa-takatsuji\">#</a> やきとり大吉 堀川高辻店（Daikichi Horikawa Takatsuji）</h2>\n<p>非常物美价廉的日式烧鸟店，大部分鸡肉部位烧串都有，特殊部分没有（提灯什么的），单串价格都在十元以内。夫妻经营，人多时上菜稍慢。但是现场烤制味道好，厨师会英文可以聊天。还有烤饭团鸡肉汤和主食小吃，味道比较稀松平常。入座必须要点一杯饮料，送了一碗卷心菜沙拉。</p>\n<p>大宮駅附近，日式居酒屋风格餐厅，店内位置少</p>\n<p>有中英文菜单，可以支付宝</p>\n<h2 id=\"smart-咖啡店\"><a class=\"anchor\" href=\"#smart-咖啡店\">#</a> Smart 咖啡店</h2>\n<p>少有的早餐店（虽然便利店和一般咖啡店也可以吃早饭）。法式吐司外层浸透了蛋液，烘焙出的焦化外壳非常酥脆，内部吐司绵软，有蜂蜜甜浆搭配，不会太甜（甜品的最高评价是不甜）。舒芙蕾松饼和各种三明治也做的不错，手工焦糖布丁口感密实。有各种饮品可点。二楼有提供午餐，经典的一些日式西餐。</p>\n<p>京都市役所前駅 徒歩 1 分 西式复古风格餐厅 环境氛围好</p>\n<p>英文菜单 多种支付方式 通常都会排队</p>\n<h2 id=\"麺屋-猪一\"><a class=\"anchor\" href=\"#麺屋-猪一\">#</a> 麺屋 猪一</h2>\n<p>连续八年获得米其林推荐的拉面馆，汤头确实是醇厚鲜香的没话说，据说是不使用猪肉鸡肉等动物脂肪，仅用鲣鱼片提取的海鲜高汤，可以选择白酱油还是黑酱油汤底，黑酱油是二次熟成的，味道更厚一点。可以搭配柚子皮小碟解腻，面条几乎没有缺点，劲道入味。桌上有调味粉可选（黑七味粉 / 山椒粉 / 昆布等），Topping 可以选炙烤和牛或者温泉蛋等。有丼饭和烧麦小吃可选。</p>\n<p>京都河原町駅 徒歩 6 分 日式风格餐厅</p>\n<p>京都有两家店 只接受现场排队 店里不能随便拍照 只能拍食物 甚至有周边衣服和料理包卖 排队久</p>\n<h2 id=\"maccha-house-抹茶館-京都清水産寧坂\"><a class=\"anchor\" href=\"#maccha-house-抹茶館-京都清水産寧坂\">#</a> MACCHA HOUSE 抹茶館 京都清水産寧坂</h2>\n<p>浅尝了一下宇治抹茶提拉米苏，最底下是抹茶戚风蛋糕，中间层起司内馅，上面撒抹茶粉。蛋糕被浸泡的有点潮比较影响口感，但整体内馅和抹茶的味道都是极好的，很香，不甜！最高评价。但其实在二三年坂商业街的抹茶甜点比比皆是，口味应该大差不差。</p>\n<p>巴士『清水道』站下车步行 6 分钟 日式庭院风格甜品店</p>\n<p>在日本拥有 7 家门店，有英文菜单，多种支付方式</p>\n<h2 id=\"sushitetsu\"><a class=\"anchor\" href=\"#sushitetsu\">#</a> Sushitetsu</h2>\n<p>京阪三条駅 徒歩 5 分 日式风格餐厅</p>\n<p>有中英文菜单 支持信用卡 现场排队需要先门口填名字再排队</p>\n",
            "tags": [
                "旅行日志",
                "日本跨年行",
                "旅行",
                "唯有美食与爱不可辜负"
            ]
        },
        {
            "id": "http://example.com/travel/japan/route/",
            "url": "http://example.com/travel/japan/route/",
            "title": "15天9城特种兵行程总结",
            "date_published": "2024-02-03T16:00:00.000Z",
            "content_html": "<h1 id=\"關西\"><a class=\"anchor\" href=\"#關西\">#</a> 關西</h1>\n<p>⌀ 1.21 神戶 DAY1</p>\n<p>厦门高崎机场 --&gt; 大阪关西机场</p>\n<p>⌀ 1.22 大阪 DAY2 市內景點走走</p>\n<p>⌀ 1.23 大阪 DAY3 環球影城？？or 機動</p>\n<p>⌀ 1.24 京都 DAY4 市內走走</p>\n<p>⌀ 1.25 京都 DAY5 市周圍走走？ 可以嵐山 或者宇治</p>\n<p>⌀ 1.26 奈良 DAY6</p>\n<p>⌀ 1.27 名古屋 DAY7 真不一定去吧 可以換箱根或者鐮倉？或者加到東京去</p>\n<h1 id=\"關東\"><a class=\"anchor\" href=\"#關東\">#</a> 關東</h1>\n<p>⌀ 1.28 富士山 DAY1</p>\n<p>⌀ 1.29 東京 DAY2 淺草寺 晴空塔 秋葉原 新宿歌舞町 天空樹</p>\n<p>⌀ 1.30 東京 DAY3 東京塔 明治神宮 代代木公園 澀谷 sky 穿插</p>\n<p>⌀ 1.31 東京 DAY4 機動 下午或晚上需要到達坐船點或者飛機點</p>\n<h1 id=\"北海道\"><a class=\"anchor\" href=\"#北海道\">#</a> 北海道</h1>\n<p>⌀ 2.1 札幌 DAY1 市中心走景點：圆山动物园→北海道神宫→白色恋人工厂→JR 塔展望室 T38 (夜景)→  狸小路 → 二条市场→札幌电视塔（大通公园 / 札幌钟楼）→ 中岛公园（或头大佛）→ 藻岩山展望台 (夜景)</p>\n<p>⌀ 2.2 札幌 DAY2 找個交通好一點的地方滑雪 酒店可不變 （19 號來的人該走了）</p>\n<p>⌀ 2.3 小樽 DAY3 市中心走 可以住小樽或者札幌 情懷散步</p>\n<p>⌀ 登別 DAY4</p>\n<p>⌀ 函館 DAY5</p>\n",
            "tags": [
                "旅行日志",
                "日本跨年行",
                "旅行"
            ]
        },
        {
            "id": "http://example.com/projects/punch_go/",
            "url": "http://example.com/projects/punch_go/",
            "title": "基于以太坊的『Punch Go』去中心化应用(DAPP)",
            "date_published": "2022-05-10T16:00:00.000Z",
            "content_html": "<h1 id=\"背景介绍\"><a class=\"anchor\" href=\"#背景介绍\">#</a> 背景介绍</h1>\n<p>本项目的目标是开发一个去中心化应用 (DAPP) 平台，以促进打孔目标发起者和拥有类似目标的个人之间的联系。目标发起者将通过引入与目标相关的共享价值、设置参与存款要求和指定活动截止日期来发起打孔活动。平台用户可以访问所有正在进行或已经完成的打孔活动。如果活动正在进行，用户可以通过存款指定数量的加密货币来加入。为了保持在打孔活动中的积极性，用户必须每天打孔；如果失败，将导致他们的存款被没收。在每次打孔活动结束时，所有存款将平均分配给每天坚持打孔的用户。</p>\n<p>我们的项目旨在建立目标发起者和目标追逐者之间的联系，使我们的用户能够在获得金钱奖励的同时实现目标；同时，那些缺乏毅力的人将面临后果。</p>\n<h1 id=\"创意来源\"><a class=\"anchor\" href=\"#创意来源\">#</a> 创意来源</h1>\n<p>从项目一开始，我们就想了解更多关于如何构建 DAPP 的知识。我们首先想要复制一个众筹 DAPP。但在那个众筹项目中，我们创新地增加了在众筹截止日期前申请使用资金的功能。发起人可以在他认为需要的时候申请。但他必须填写一份申请表，并解释这笔资金的用途。然后，赞助者可以在使用详情部分查看此应用程序。发起人可以选择同意或拒绝发起人的申请。如果商定的总百分比超过 50%，那么发起者可以获得这笔资金供他使用。</p>\n<p>然后，我们有了 “打拳” 的想法。这是因为我们在准备实习或全职工作面试时经常需要练习 LeetCode。但由于人们有惯性，我们不能坚持练习很长时间。更具体地说，我们中的许多人可能都有这样的情况：我们有一个重要的目标要实现，也许用 LeetCode 更好地编程，或者像外国人一样用托福练习英语，但只是没有足够的内在动力来实现它。在过去，许多新年计划由于缺乏自我控制而被放弃。所以，我们需要一些激励和惩罚。这就是我们的 “Punch Go” DAPP 旨在提供的。“打拳” 这个概念近年来一直是一个热门话题，一群人有一个共同的目标，并相互监督以实现这一目标。在区块链技术的帮助下，我们可以将打卡的想法推向更高的标准。在 “Punch Go” 的典型场景中，存在三个利益相关者：提出共同目标的项目发起人，拥有相同目标并愿意致力于此的一群人，以及将双方联系在一起的平台。</p>\n<p>之后，我们发现 “打卡” 与 “众筹” 有着非常紧密的内在联系。本质上，他们都是从参与者 (赞助商) 那里收钱，然后再进行再分配。在 “众筹” 中，资金被重新分配给发起人。但在 “打卡” 中，资金被重新分配给每一个坚持 “打卡” 活动的人。</p>\n<p>此外，我们建议必须增加一些 “打卡” 的监督机制。我们不能让用户的 “打卡” 立即得到同意，因为用户可能会作弊。因此，我们增加了 “批准” 和 “拒绝” 功能，以便用户监督其他人的 “打卡”。一旦 “打卡” 得到 50% 以上剩余参与者的认可，即为有效。幸运的是，这与我们在 “众筹” 系统中完成的实现是相似的。</p>\n<h1 id=\"开发框架\"><a class=\"anchor\" href=\"#开发框架\">#</a> 开发框架</h1>\n<h2 id=\"环境配置\"><a class=\"anchor\" href=\"#环境配置\">#</a> 环境配置</h2>\n<p><strong>技术栈:</strong> Nodejs + React + Solidity</p>\n<p><strong>前端 UI:</strong> bootstrap</p>\n<p>要运行这个项目，您需要为这个 DAPP 设置基本环境。你应该安装 React + Web3 + npm + truffle。此外，您应该在 Edge 浏览器中安装 MetaMask。您还应该在 Edge 浏览器中安装 MetaMask Legacy Web3 扩展，以便我们的网站可以与区块链进行交互。</p>\n<p>注意：这里你可以使用 Edge 或 Firefox 浏览器来运行我们的项目，Chrome 不受支持，因为它不能安装 MetaMask Legacy Web3 扩展。</p>\n<h2 id=\"启动步骤\"><a class=\"anchor\" href=\"#启动步骤\">#</a> 启动步骤</h2>\n<ol>\n<li>使用 Ganache 导入 truffle-config.js</li>\n</ol>\n<p><img data-src=\"/assets/punch_go/workspace.png\" alt=\"alt text\" title=\"Ganache设置\"></p>\n<ol start=\"2\">\n<li>\n<p>使用命令 “truffle migrate” 编译 solidity 的智能合约</p>\n</li>\n<li>\n<p>在 Ganache 中找到部署的合同地址，并将该地址复制到 “client/src/eth/punch .js” 第 299 行地址变量中</p>\n</li>\n</ol>\n<p><img data-src=\"/assets/punch_go/contract2.png\" alt=\"alt text\" title=\"合约地址\"></p>\n<ol start=\"4\">\n<li>\n<p>使用 CMD 命令进入客户端目录 &quot;cd client&quot;</p>\n</li>\n<li>\n<p>使用 npm 来安装依赖 &quot;npm install&quot;</p>\n</li>\n<li>\n<p>运行这个项目 &quot;npm run start&quot;</p>\n</li>\n<li>\n<p>如果运行成功，您可以在 “localhost:3000” 上找到我们的项目。</p>\n</li>\n</ol>\n<p><img data-src=\"/assets/punch_go/home_page.png\" alt=\"home\" title=\"首页\"></p>\n<h1 id=\"功能介绍\"><a class=\"anchor\" href=\"#功能介绍\">#</a> 功能介绍</h1>\n<p>如前所述，第一个实现的想法是一个众筹应用程序，它支持用户发起融资或参与特定的众筹项目。当一个特定的资金发起者想要花费这笔钱时，需要一半的参与者批准交易，项目发起者才能真正花费所需的金额。</p>\n<p>在我们建立了这个众筹平台之后，我们提出了另一个名为 “Punch Go” 的想法来帮助人们完成日常任务。考虑到众筹 DAPP 更像是初学者的启动项目，我们决定用这个新想法来真正动手。背后的理论是非常相似的。在本节中，我们将重点讨论第二个想法的功能。</p>\n<p>首先，在我们进入细节之前，需要对 “Punch Go” 的整体情况进行简要介绍。我们的应用程序，顾名思义，是帮助人们摆脱拖延症的监督者。这是一个人们可以发起或参与打拳活动的平台。当然，参加这样的活动需要一些钱来激励个人每天打卡，但如果参与者达到了他们设定的目标，他们就会得到奖励，分享池中的存款。现在我们来看一下详细的功能。</p>\n<p>在我们的应用程序的主页上，它显示了网络上所有活动的概述，包括打孔活动的总数、已完成的打孔活动和正在进行的打孔活动。如果用户有兴趣，可以导出所有打孔活动的统计报表。此外，用户的账户地址将显示在页面的右上角，供用户查看和确认钱包中当前的加密货币账户。一旦用户在 MetaMask 中更改帐户，金额将立即在我们的前端更新。此外，还增加了搜索功能，以便用户可以找到任何记录的感兴趣的打孔活动。</p>\n<p>其次，启动器的最小功能单元是启动一个新的冲孔活动。在 “打孔发起” 一栏，用户可以填写自己的打孔活动信息，包括活动名称、主要目标、截止时间、参与金额等。将检查每条消息的有效性。一旦所有输入的信息都是有效的，发起者就可以确认这个新的活动，它将更新网络中部署的合约。应用程序将自动连接到 MetaMask，并扣除此类操作的 gas 费用。</p>\n<p>在 “All Punches” 部分中，记录中存储的每个活动都将显示为带有其名称和状态标记的块标记。通过点击 “查看详情”，将显示有关这些活动的所有具体信息。“查看详情” 面板包含发起人的信息，以及活动操作过程的必要信息，包括项目状态 (已完成或正在进行)，总保证金，参与本次打孔活动的总人数以及剩余参与者 (因为有些人可能会放弃)。如果您不是本次活动的发起者，会有一个 “我想参与” 按钮让您加入当前的活动。一旦你加入了一个活动，右上角会有一个绿色的打孔按钮，你可以在那里打孔。</p>\n<p>还有一个界面供用户检查与自己相关的活动。参与者可以在 “参加的出拳次数” 一栏查看出拳情况，以便监督自己参加的所有出拳的过程。发起者也可以在 “发起打孔” 中查看自己发起的活动信息，查看打孔活动情况。</p>\n<p>活动通常会在截止日期前结束，只要你完成了你设定的目标，你就会得到一份。但是，如果您在活动期间放弃，您的会议将提前结束，您将被从参与者名单中除名，以防止一些恶意投票。</p>\n<p><img data-src=\"/assets/punch_go/punch.png\" alt=\"\" title=\"日常打卡登记注册\"></p>\n<p>具体来说，有一种机制让参与者每天打卡。如上图所示，发起者可以提交一个包含打孔日期和打孔内容的表单。此时，项目详情页面将出现一个状态栏 (如下图所示)。<br>\n。其他参与者可以根据是否同意而选择批准或拒绝打孔请求。一旦超过 50％的参与者同意这样的请求，你就成功打卡了。如果在一定时间内没有足够的人同意，该请求将被拒绝，该用户将被移出参与者列表。</p>\n<p>![](/assets/punch_go/0% approve.png&gt;)</p>\n<p>![](/assets/punch_go/100% appove.png)</p>\n<p><img data-src=\"/assets/punch_go/initiation_success.png\" alt=\"initiation success\"></p>\n<p><img data-src=\"/assets/punch_go/response.png\" alt=\"alt text\"></p>\n<p><img data-src=\"/assets/punch_go/punch_success.png\" alt=\"alt text\"></p>\n<p><img data-src=\"/assets/punch_go/response.png\" alt=\"alt text\"></p>\n<h1 id=\"效果展示\"><a class=\"anchor\" href=\"#效果展示\">#</a> 效果展示</h1>\n<p>在本部分中，我们将向您展示应用程序中的一些特定示例。整个主页如图 \\ref {fig:home} 所示，展示了账号地址和搜索功能。显示总览统计信息，并显示进程速率。</p>\n<p>我们假设有人想要建立一个新的冲孔活动，如图 \\ref {fig:Initiate a punch} 所示。应用程序将给出如图 \\ref {fig:initiation success} 所示的响应。因此，将设置一个名为 “leetcode” 的冲床，其状态为 “正在进行”，其参与费用和截止日期见图 \\ref {fig:activity detail}。当有人有相同的目标，想要加入这样的活动来提高自己时，“我想参与” 按钮位于页面的左下角。用户进入冲床后，通过图 \\ref {fig:Punch detail} 中的 “冲床” 功能完成每天的任务并提交内容进行验证。其他用户可以选择同意或拒绝某人的 “工作”，就像图 \\ref {fig:Punch-checking} 一样。如果您选择批准穿孔内容，将出现图 \\ref {fig:approve respond} 的响应。只要超过 50％的人同意你的 punch，当天的任务就可以确定了。以便参与者可以在第二天继续打孔活动。所有的冲孔都可以在图 \\ref {fig:All punches} 上看到。作为发起人，您可以管理您的活动页面 “发起的拳头”，如图 \\ref {fig:activity initiated} 所示。而对于参与者，图 \\ref {fig:activity participated} 中的信息将为您提供所参加活动的一致更新。</p>\n<h1 id=\"结论及未来工作\"><a class=\"anchor\" href=\"#结论及未来工作\">#</a> 结论及未来工作</h1>\n<p>我们项目的意义在于将拥有相同目标的人们联系在一起。我们使用 Node.js, React 和 Solidity 开发了一个 DAPP 平台，使不同的人之间能够进行共享价值的交流。平台功能包括显示正在进行的冲孔活动进度和完成的冲孔目标的仪表板，启动冲孔活动并提供发起者输入信息，冲孔活动完成后向目标实现者发送费用。</p>\n<p>对于未来的工作，我们的目标是增加功能，使我们的平台更容易使用，并具有更丰富的功能。完善监督机制，加强制度安全是我们的首要任务。解决活动被恶意方控制的风险对于保护其他用户非常重要。我们计划为那些认为自己的打卡被拒绝时应该被批准的用户增加申诉机制的功能。此外，给别人打卡 “拒绝” 标签的用户也应该在我们 DAPP 的未来版本中说明他们的理由。另外，我们计划增加活动发起者每天设置一些任务，要求参与者打卡的功能。</p>\n",
            "tags": [
                "科研项目",
                "区块链",
                "开发"
            ]
        },
        {
            "id": "http://example.com/projects/stream_processing/",
            "url": "http://example.com/projects/stream_processing/",
            "title": "用深度强化学习实时预测和交易加密货币",
            "date_published": "2022-05-07T16:00:00.000Z",
            "content_html": "<div class=\"note info\">\n<p>可以在此处找到项目的原代码 <span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL01pcmFjbGVMaW56enovS2Fma2FSZWFsVGltZUNyeXB0b2N1cnJlbmN5\">📍链接</span></p>\n</div>\n<h1 id=\"背景介绍-瞎鸡儿凑字数\"><a class=\"anchor\" href=\"#背景介绍-瞎鸡儿凑字数\">#</a> 背景介绍 <s>(瞎鸡儿凑字数)</s></h1>\n<h2 id=\"为什么要用强化学习\"><a class=\"anchor\" href=\"#为什么要用强化学习\">#</a> 为什么要用强化学习？</h2>\n<p>股票交易是一种优先考虑短期利润而不是长期回报的投资形式。因此，在进行股票交易时，有必要具备专业知识。大多数股票投资者都知道基本面分析中最常用的财务数据。在此分析的基础上，他们可以进行量化交易。</p>\n<p>近年来，越来越多的公司试图利用人工智能来建立<span class=\"red\">机器学习模型</span>，以此来改进他们的交易策略。</p>\n<p>在我们的项目中，我们在股票市场的背景下，建立了<span class=\"red\">强化学习模型</span>，对比特币的交易进行实时决策。</p>\n<p>股票市场包括历史价格序列和走势，可以看作是一个复杂的环境。我们的目标是培养一个能自己对买入和卖出股票做决定的代理单元。因此，<span class=\"red\">强化学习算法</span>可以有效地解决这个问题。</p>\n<p>强化学习的目的是优化累积的未来奖励信号，以便为序列选择问题制定适当的策略。在研究了部分金融投资组合管理问题的深度强化学习框架后，发现部分 Q 学习算法，如</p>\n<ul>\n<li><span class=\"red\">异步优势演员 - 评论家算法</span> (Asynchronous Advantage Actor-Critical, A3C)</li>\n<li><span class=\"red\">信赖域策略优化算法</span> (Trust Region Policy Optimization, TRPO)</li>\n</ul>\n<p>在某些条件下存在明显高估的动作价值，继而影响最终的性能。相比之下，<span class=\"red\">DQN</span> (Deep Q-network) 通过将 Q 学习与深度神经网络相结合来解决这些问题，不仅减少了观察到的高估值，而且在一些博弈理论上显著地提高了性能。</p>\n<h2 id=\"为什么要用流处理\"><a class=\"anchor\" href=\"#为什么要用流处理\">#</a> 为什么要用流处理</h2>\n<p>在传统的投资组合管理问题中使用流处理的原因是为了解决两个重要的量化交易问题:</p>\n<ul>\n<li>数据数量上的短缺</li>\n<li>数据本身质量低</li>\n</ul>\n<p>金融数据信息处理需要从海量的噪声中提取有意义的数据。由于金融市场上存在大量的噪音，人们最朴素期待的结果就是自己做出的决策事正确决策的概率大于 50%。</p>\n<p>但事实总是不尽人意，通常来说，基于以往有限样本的旧数据进行的预测研究往往很难达到令人接受的程度。</p>\n<p>故，金融和经济学领域的强化学习研究通常不会在 “大数据” 背景下进行。</p>\n<p>为了解决上述问题，使我们的系统具有更现实的意义和更多的商业价值，我们构建了一个集成深度强化学习模型和 Kafka 流处理方法的系统，来获取和处理实时股票数据。可以同时处理多种加密货币数据。</p>\n<p><img data-src=\"/assets/stream_processing/image.png\" alt=\"&quot;深度强化学习(DRL)模型&quot;\" title=\"深度强化学习(DRL)模型\"></p>\n<h1 id=\"强化学习模型\"><a class=\"anchor\" href=\"#强化学习模型\">#</a> 强化学习模型</h1>\n<p>强化学习训练的一个重要步骤是 Q 值表的更新，其中 Bellman 方程起着至关重要的作用。Bellman 方程的主要思想是利用下一个状态信息 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">v_{t+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.638891em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span> 得到当前状态的 Q 值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>v</mi><mi>t</mi></msub></mrow><annotation encoding=\"application/x-tex\">v_t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>Q</mi><mi>π</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>E</mi><mi>π</mi></msub><mo stretchy=\"false\">[</mo><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>γ</mi><msub><mi>Q</mi><mi>π</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator=\"true\">,</mo><msub><mi>A</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">∣</mi><msub><mi>S</mi><mi>t</mi></msub><mo>=</mo><mi>s</mi><mo separator=\"true\">,</mo><msub><mi>A</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">Q_{\\pi}(s,a) = E_{\\pi}[R_{t+1}+\\gamma Q_{\\pi}(S_{t+1},A_{t+1})|S_t = s,A_t = a]\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">]</span></span></span></span></span></p>\n<p>其中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>π</mi></msub><mo stretchy=\"false\">(</mo><mi>s</mi><mo separator=\"true\">,</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Q_{\\pi}(s,a)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">s</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">)</span></span></span></span> 是基于当前状态 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">s</span></span></span></span> 和遵循策略 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span> 的动作 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span> 的 Q 值。<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Q</mi><mi>π</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>S</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator=\"true\">,</mo><msub><mi>A</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Q_{\\pi}(S_{t+1},A_{t+1})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">Q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.151392em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">π</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 是下一个状态 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>s</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">s_{t+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.638891em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span> 和此状态下的动作 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>a</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">a_{t+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.638891em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span> 给出的 Q 值。 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>R</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">R_{t+1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.891661em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span></span></span></span> 表示下一刻的奖励。<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>γ</mi></mrow><annotation encoding=\"application/x-tex\">\\gamma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span> 是从 0 到 1 的折扣因子</p>\n<p>DQN 中有 2 个神经网络，其中一个是策略网络，另一个是价值网络，它可以将状态映射到 (动作，Q 值) 对。在 DQN 训练中，更新神经网络权值时，Bellman 方程起着重要的作用</p>\n<p>DQN 的核心部分是嵌入式 CNN 模型。对于我们项目中的状态空间，7 个技术指标用来表示状态环境:<br>\n<span class=\"label primary\"> 平衡</span><span class=\"label primary\">价格</span><span class=\"label primary\">股票</span><span class=\"label primary\"> MACD</span><span class=\"label primary\">RSI</span><span class=\"label primary\">CCI</span><span class=\"label primary\">ADX</span><br>\n 在每次状态迭代中，Q 值表都会被更新，agent 代理可以根据这些信息学习相应的策略</p>\n<p>对于训练和测试数据，我们使用了 2015-2022 年的 Kaggle 开源 candle chart 数据，包括 BTCUSDT 和 Ethusdt 的<span class=\"label primary\">开盘价</span><span class=\"label primary\">高点</span><span class=\"label primary\">低点</span><span class=\"label primary\">收盘价</span>。由于加密货币每周 7 天，每天 24 小时运行，因此我们的输入数据为 5GB 的 7 年数据</p>\n<p><img data-src=\"/assets/stream_processing/data.png\" alt=\"数据\" title=\"数据集\"></p>\n<p>7 年票证数据除了量大、处理资源需求大之外，还包含了大量 2018-2021 年不需要的动荡数据和长期牛市数据，这可能会影响我们模型的训练结果</p>\n<p>我们选择了几个典型的时间段进行综合整合，包括牛市，熊市和高动荡市场 (2017 - 2018,2019 - 2020,2020-2021)。价格历史数据集标记良好、并预先格式化</p>\n<p>为了提高网络收敛的速度，我们将数据归一化 (0 到 1 之间)。然后我们用模型进行了几次训练试验，但结果并不令人满意。我们认为，仅仅使用原始的价格数据可能不够充分。技术指标可能比价格数据能够为市场提供更多的信息。因此，我们决定将其包含在我们的数据集中，以提高模型的性能。</p>\n<p>RSI、MACD 和 BRAR 技术指标是根据我们从 kaggle 收到的原始数据，使用 technical-indicators-lib 生成的</p>\n<p><img data-src=\"/assets/stream_processing/result.png\" alt=\"结果\" title=\"模型结果\"></p>\n<p>我们对模型的超参数进行了微调。使用了 ReLU 和 Adam。用 Btcusdt 历史数据 (2017 - 2018,2019 - 2020,2020-2021) 来训练模型，2022.01 至 2022.04 来测试预训练的模型。我们将初始收益定为 100 万美元。</p>\n<p>这种策略每天交易约 18 次。曲线如下图所示：最大 draw down 为 8％，年收益率为 30％，sharpe ratio 为 2.6。上图显示了利润与交易时间的关系</p>\n<h1 id=\"流处理操作流程\"><a class=\"anchor\" href=\"#流处理操作流程\">#</a> 流处理操作流程</h1>\n<p>一旦我们导出了经过训练的强化学习模型，我们就可以通过一系列技术工具构建应用程序来获得实时预测结果。 如下图所示</p>\n<p><img data-src=\"/assets/stream_processing/flowchart.png\" alt=\"&quot;总体技术栈流程图&quot;\" title=\"总体技术栈流程图\"></p>\n<p>整个项目流程图可以简单地分为几个部分，包括</p>\n<ul>\n<li>数据采集与流数据转换</li>\n<li>流数据处理</li>\n<li>流数据预测</li>\n<li>数据可视化</li>\n</ul>\n<h2 id=\"环境配置准备\"><a class=\"anchor\" href=\"#环境配置准备\">#</a> 环境配置准备</h2>\n<p>建议使用 Anaconda 创建虚拟环境<br>\n <code>conda create -n your_env_name python=x.x</code></p>\n<p>在虚拟环境中安装相应依赖</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">keras==2.3.1</span><br><span class=\"line\">tensorflow==1.14.0</span><br><span class=\"line\">pandas==0.24.2</span><br><span class=\"line\">numpy==1.16.1</span><br><span class=\"line\">tqdm==4.24.0</span><br><span class=\"line\">docopt==0.6.2</span><br><span class=\"line\">coloredlogs==10.0</span><br><span class=\"line\">jupyterlab==1.0.1</span><br><span class=\"line\">altair==4.0.0</span><br><span class=\"line\">seaborn==0.9.0</span><br><span class=\"line\"></span><br><span class=\"line\">cryptocompare</span><br><span class=\"line\">matplotlib</span><br></pre></td></tr></table></figure>\n<p><code>pip install -r requirement.txt</code></p>\n<h2 id=\"流处理软件初始化\"><a class=\"anchor\" href=\"#流处理软件初始化\">#</a> 流处理软件初始化</h2>\n<div class=\"note warning\">\n<p>这个项目是在个人电脑上运行的 demo，Windows 11 系统。实际运行可能在云平台或虚拟机 Linux 上效果更加，配置操作相应变化。</p>\n</div>\n<p>Kafka 依赖 ZooKeeper 作为分布式系统提供协调服务的工具，在启动 Kafka 服务前需要先启动 ZooKeeper 服务。<br>\n新版本 Kafka 内置了 ZooKeeper 服务（Kafka 2.8 之后），所以我们可以有两种 ZooKeeper 的启动方式<br>\n一种是单独下载 ZooKeeper，然后配置环境变量、启动服务<br>\n第二种是启动 Kafka 内置的 ZooKeeper 服务</p>\n<h3 id=\"单独搭建-zookeeper-环境并启动服务\"><a class=\"anchor\" href=\"#单独搭建-zookeeper-环境并启动服务\">#</a> 单独搭建 ZooKeeper 环境并启动服务</h3>\n<ol>\n<li>官网下载：<span class=\"exturl\" data-url=\"aHR0cHM6Ly96b29rZWVwZXIuYXBhY2hlLm9yZy8=\">https://zookeeper.apache.org/</span></li>\n<li>选择自己需要的版本，下载压缩包（本项目是 3.6.3 版本）</li>\n<li>将压缩包存放在磁盘某位置，路径无中文</li>\n<li>在 ZooKeeper 的解压缩目录中，找到 conf 文件夹，该文件夹包含了 ZooKeeper 的配置文件。复制 “zoo_sample.cfg&quot;这个文件，重命名为&quot;zoo.cfg”，修改相应配置项，如\n<ul>\n<li>dataDir：指定 ZooKeeper 存储数据的目录，默认为 /tmp/zookeeper</li>\n<li>dataLogDir：指定 ZooKeeper 存储日志的目录</li>\n<li>clientPort：指定客户端连接到 ZooKeeper 服务器的端口号，默认为 2181</li>\n<li>tickTime：指定 ZooKeeper 服务器之间的心跳间隔时间（以毫秒为单位），默认为 2000</li>\n</ul>\n</li>\n<li>创建需要的 data 和 logs 文件夹在相应目录，也可以在 cmd 命令行里全局指定地址，如</li>\n</ol>\n<figure class=\"highlight shell\"><figcaption><span>mark:1</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">set ZOOKEEPER_LOGS_PATH=C:\\tmp\\zookeeper</span><br></pre></td></tr></table></figure>\n<ol start=\"6\">\n<li>编辑 path 系统变量，添加路径 <code>%ZOOKEEPER_HOME%\\bin</code> ，ZOOKEEPER_HOME 为文件夹路径</li>\n<li>打开 cmd 命令窗口，输入 zkServer，启动 ZooKeeper 服务。关闭窗口则结束服务</li>\n</ol>\n<h3 id=\"下载kafka\"><a class=\"anchor\" href=\"#下载kafka\">#</a> 下载 Kafka</h3>\n<ol>\n<li>官网下载：<span class=\"exturl\" data-url=\"aHR0cDovL2thZmthLmFwYWNoZS5vcmcvZG93bmxvYWRz\">http://kafka.apache.org/downloads</span></li>\n<li>选择自己需要的版本，下载压缩包（本项目是 2.12-3.1.0 版本）</li>\n</ol>\n<h3 id=\"启动kafka内置的zookeeper服务\"><a class=\"anchor\" href=\"#启动kafka内置的zookeeper服务\">#</a> 启动 Kafka 内置的 ZooKeeper 服务</h3>\n<ol>\n<li>将压缩包存放在磁盘某位置，路径无中文，新建 data 文件夹</li>\n<li>进入 &quot;config&quot; 目录，用编辑软件打开 &quot;zookeeper.properties&quot; 文件，修改 &quot;dataDir&quot;</li>\n<li>打开 cmd 命令窗口，进入 Kafka 解压包根目录，输入命令行启动 Kafka 内置的 ZooKeeper 服务。关闭 cmd 窗口即关闭服务</li>\n</ol>\n<figure class=\"highlight shell\"><figcaption><span>mark:1</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\bin\\windows\\zookeeper-server-start.bat .\\config\\zookeeper.properties</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/assets/stream_processing/zookeeper.png\" alt=\"Start and initialize Zookeeper\" title=\"ZooKeeper启动成功\"></p>\n<h3 id=\"启动kafka\"><a class=\"anchor\" href=\"#启动kafka\">#</a> 启动 Kafka</h3>\n<ol>\n<li>在 Kafka 解压包根目录下新建 &quot;kafka-logs&quot; 文件夹</li>\n<li>进入 &quot;config&quot; 目录，用编辑软件打开 &quot;server.properties&quot; 文件，找到 &quot;log.dirs&quot; 配置，将其路径设置为我们新建的 &quot;kafka-logs&quot; 目录的路径。如果有修改 ZooKeeper 服务的默认端口或 ip, 可以同时编辑 “zookeeper.connect”，更改 ZooKeeper 服务的 ip 和端口号配置</li>\n<li>打开 cmd 命令窗口，进入 Kafka 解压包根目录下，输入命令行，启动 Kafka。关闭 cmd 窗口即关闭服务</li>\n</ol>\n<figure class=\"highlight shell\"><figcaption><span>mark:1</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.\\bin\\windows\\kafka-server-start.bat .\\config\\server.properties</span><br></pre></td></tr></table></figure>\n<p><img data-src=\"/assets/stream_processing/kafka.png\" alt=\"Start and initialize Kafka\" title=\"Kafka启动成功\"></p>\n<details class=\"warning\"><summary>可能存在的报错</summary><div>\n<ul>\n<li>\n<p>端口占用<br>\n可以用  <code>netstat -ano | findstr 2181</code>  找到占用端口的 pid，然后用  <code>taskkill /f /pid pid号</code>  关闭即可</p>\n</li>\n<li>\n<p>Kafka 执行完就 shutting down<br>\n 可能是 Kafka 集群 id 跟元数据 &quot;meta.properties&quot; 中存储的不一致，导致启动失败。只需要将 Kafka 配置文件 &quot;server.properties&quot; 中 &quot;log.dirs&quot; 配置的 &quot;kafka-logs&quot; 目录下的文件全部删除，重新执行 Kafka 的启动命令即可。ZooKeeper 同理</p>\n</li>\n<li>\n<p>timeindex.cleaned 另一个程序正在使用此文件，进程无法访问<br>\n可能由于非正常关闭 Kafka, 导致其无法完成对日志文件完成解锁。将 &quot;kafka-logs&quot; 路径下的文件全部删除重启即可</p>\n</li>\n<li>\n<p>目录层级太深或者是目录名字太长可能导致启动失败</p>\n</li>\n</ul>\n</div></details>\n<div class=\"note danger\">\n<p>Kafka 和 Spark Dstream 之间的版本问题:</p>\n<ul>\n<li>Spark 2.4 之后，没有针对 Spark Streaming 的更新（已弃用），这意味着两者之间没有 API。<br>\n <code>from pyspark.streaming.kafka import KafkaUtils</code></li>\n<li>Structured Streaming 成为主流流处理数据结构</li>\n<li>需要一个配置文件用于连接 Kafka 和 Spark Streaming，他的版本也关系到能否起到兼容效果。</li>\n<li>此外还有需要注意的有\n<ul>\n<li>Py4J 的兼容性问题</li>\n<li>Java JDK 的兼容性问题</li>\n<li>高版本 Python 的兼容性问题</li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight python\"><figcaption><span>mark:1-3</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java8_location = <span class=\"string\">&#x27;%JAVA_HOME%\\Java\\jdk1.8.0_331&#x27;</span> </span><br><span class=\"line\">os.environ[<span class=\"string\">&#x27;JAVA_HOME&#x27;</span>] = java8_location</span><br><span class=\"line\">os.environ[<span class=\"string\">&#x27;PYSPARK_SUBMIT_ARGS&#x27;</span>] = <span class=\"string\">&#x27;--jars spark-streaming-kafka-0-8-assembly_2.11-2.1.1.jar pyspark-shell&#x27;</span></span><br></pre></td></tr></table></figure>\n</div>\n<p>使用 <span class=\"red\">Cryptocompare API</span> 来获取指定加密货币的实时价格以及相应的其他附加信息。原始数据以 <code>&#123;name, currency, amount, time&#125;</code> （加密货币名，对标货币名，货币量，时间）的字典形式打包</p>\n<p>我们定义并初始化多个 Kafka 生产者，不同的价格信息将按其不同主题（其加密货币名称）分隔并存储在 Broker 上（这个 Broker 依赖 ZooKeeper 的分布式存储）。并发送日志记录当前实时数据情况</p>\n<figure class=\"highlight python\"><figcaption><span>生产者</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">initProducer</span>():</span><br><span class=\"line\">    <span class=\"comment\"># init an instance of KafkaProducer</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Initializing Kafka producer at &#123;&#125;&#x27;</span>.<span class=\"built_in\">format</span>(time.time()))</span><br><span class=\"line\">    producer = KafkaProducer(bootstrap_servers=config[<span class=\"string\">&#x27;kafka_broker&#x27;</span>], api_version=(<span class=\"number\">0</span>,<span class=\"number\">11</span>,<span class=\"number\">5</span>))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Initialized Kafka producer at &#123;&#125;&#x27;</span>.<span class=\"built_in\">format</span>(time.time()))</span><br><span class=\"line\">    <span class=\"keyword\">return</span> producer</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">produceRecord</span>(<span class=\"params\">data, producer, topic, partition=<span class=\"number\">0</span></span>):</span><br><span class=\"line\">    <span class=\"comment\"># act as a producer sending records on kafka</span></span><br><span class=\"line\">    producer.send(topic=topic, partition=partition, value=<span class=\"built_in\">bytes</span>(<span class=\"built_in\">str</span>(data), <span class=\"string\">&#x27;utf-8&#x27;</span>))</span><br><span class=\"line\">    <span class=\"comment\"># debug \\ message in prompt</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Produce record to topic \\&#x27;&#123;0&#125;\\&#x27; at time &#123;1&#125;&#x27;</span>.<span class=\"built_in\">format</span>(topic, time.time()))</span><br></pre></td></tr></table></figure>\n<p>Broker 充当生产者和消费者之间信息的渠道。 在这个过程中，所有这些组件都需要向 Zookeeper 注册。 Kafka 集群使用 Zookeeper 来管理 Kafka 配置并选举领导者。 所有主题和代理之间的映射由 Zookeeper 维护。 而当 Consumer Group 发生变化时，就会进行重新平衡。 由于我们仅在一台 PC 上运行演示，因此未应用分区配置。</p>\n<p><img data-src=\"/assets/stream_processing/kafka1.png\" alt=\"\" title=\"生产者消费者运行示意图\"></p>\n<figure class=\"highlight python\"><figcaption><span>消费者</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">initConsumer</span>(<span class=\"params\">topic, timeout=<span class=\"number\">1000</span></span>):</span><br><span class=\"line\">    <span class=\"comment\"># init an instance of KafkaConsumer</span></span><br><span class=\"line\">    consumer = KafkaConsumer(topic, api_version=(<span class=\"number\">0</span>,<span class=\"number\">11</span>,<span class=\"number\">5</span>), bootstrap_servers=config[<span class=\"string\">&#x27;kafka_broker&#x27;</span>], group_id=<span class=\"literal\">None</span>,</span><br><span class=\"line\">        auto_offset_reset=<span class=\"string\">&#x27;earliest&#x27;</span>, enable_auto_commit=<span class=\"literal\">False</span>, consumer_timeout_ms=timeout)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> consumer</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">produceRecord</span>(<span class=\"params\">data, producer, topic, partition=<span class=\"number\">0</span></span>):</span><br><span class=\"line\">    <span class=\"comment\"># act as a producer sending records on kafka</span></span><br><span class=\"line\">    producer.send(topic=topic, partition=partition, value=<span class=\"built_in\">bytes</span>(<span class=\"built_in\">str</span>(data), <span class=\"string\">&#x27;utf-8&#x27;</span>))</span><br><span class=\"line\">    <span class=\"comment\"># debug \\ message in prompt</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Produce record to topic \\&#x27;&#123;0&#125;\\&#x27; at time &#123;1&#125;&#x27;</span>.<span class=\"built_in\">format</span>(topic, time.time()))</span><br></pre></td></tr></table></figure>\n<h3 id=\"spark-dstream-流处理\"><a class=\"anchor\" href=\"#spark-dstream-流处理\">#</a> Spark Dstream 流处理</h3>\n<p>Spark 作为 Consumer 获取 Broker 中的数据并转化为 Dstream。</p>\n<figure class=\"highlight python\"><figcaption><span>Spark初始化</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sc = SparkContext() </span><br><span class=\"line\"><span class=\"comment\"># sc.setLogLevel(&#x27;INFO&#x27;)</span></span><br><span class=\"line\">ssc = StreamingContext(sc, <span class=\"number\">2</span>)</span><br><span class=\"line\"><span class=\"comment\"># Instantiate a kafka stream for processing.</span></span><br><span class=\"line\">directKafkaStream = KafkaUtils.createDirectStream(ssc, [config[<span class=\"string\">&#x27;topic_1&#x27;</span>]], &#123;<span class=\"string\">&#x27;metadata.broker.list&#x27;</span>:config[<span class=\"string\">&#x27;kafka_broker&#x27;</span>]&#125;)</span><br></pre></td></tr></table></figure>\n<p>假设有几个用时间序列号标记的 Dstream。 为了消除由于我们获取高频数据而产生的异常干扰，我们设置了一个过滤操作来选择合格的候选者。原始 Dstream 被复制，以便一旦有新数据进来，就会与前一个数据进行比较。 如果它们之间的值差小于 3%，则可以允许进行进一步的操作，否则将被弃用。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data = []</span><br><span class=\"line\">time_get = []</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Starting Apache Kafka consumers and producer&#x27;</span>)</span><br><span class=\"line\">consumer_1 = initConsumer(config[<span class=\"string\">&#x27;topic_1&#x27;</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">while</span>(<span class=\"built_in\">len</span>(data)&lt;<span class=\"number\">15</span>):</span><br><span class=\"line\">    records_1 = consumeRecord(consumer_1)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> record <span class=\"keyword\">in</span> records_1:</span><br><span class=\"line\">        strings = time.strftime(<span class=\"string\">&quot;%Y,%m,%d,%H,%M,%S&quot;</span>, time.localtime(record[<span class=\"string\">&quot;time&quot;</span>]))</span><br><span class=\"line\">        t = strings.split(<span class=\"string\">&#x27;,&#x27;</span>)</span><br><span class=\"line\">        numbers = [t[<span class=\"number\">4</span>], t[<span class=\"number\">5</span>]]</span><br><span class=\"line\">        time_get.append(<span class=\"built_in\">str</span>(numbers[<span class=\"number\">0</span>]) + <span class=\"string\">&#x27;-&#x27;</span> + <span class=\"built_in\">str</span>(numbers[<span class=\"number\">1</span>]))</span><br><span class=\"line\">        <span class=\"comment\"># time.sleep(1)</span></span><br><span class=\"line\">        data.append(record[<span class=\"string\">&quot;amount&quot;</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">initial_offset = data[<span class=\"number\">1</span>] - data[<span class=\"number\">0</span>]</span><br></pre></td></tr></table></figure>\n<p>经过初步选择后，对 Dstream 进行窗口操作。 窗口长度设置为 15 ，步幅 1。 一旦有新数据进来，旧记录就会消失。 一定程度上解决了数据短缺的问题。处理后的数据将被推送回 Broker，成为一个新的主题。</p>\n<p><img data-src=\"/assets/stream_processing/stream_operations.png\" alt=\"\" title=\"Spark流处理模块示意\"></p>\n<p>随后，该模型将从 Broker 获取数据作为新的 Consumer。 由于模型相对复杂，我们在利用模型进行预测时并没有完全采用流式处理。 我们没有使用 Spark MLlib 中的操作。</p>\n<p>相反，从 Broker 中提取的数据将更改为 DataFrame 并由模型以正常方式读取。 最后，结果会形成折线图显示在前端页面。</p>\n<p>此外，还初始化了另一组 Consumer 来代表不同加密货币的信息，以便在网站上显示价值。</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> request.is_websocket():</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;websocket connection....&#x27;</span>)</span><br><span class=\"line\">    msg = request.websocket.wait()  <span class=\"comment\"># 接收前端发来的消息</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(msg, <span class=\"built_in\">type</span>(msg), json.loads(msg))  <span class=\"comment\"># b&#x27;[&quot;1&quot;,&quot;2&quot;,&quot;3&quot;]&#x27; &lt;class &#x27;bytes&#x27;&gt; [&#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;]</span></span><br><span class=\"line\">    consumer_1 = initConsumer(config[<span class=\"string\">&#x27;topic_1&#x27;</span>])</span><br><span class=\"line\">    consumer_2 = initConsumer(config[<span class=\"string\">&#x27;topic_2&#x27;</span>])</span><br><span class=\"line\">    consumer_3 = initConsumer(config[<span class=\"string\">&#x27;topic_3&#x27;</span>])</span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"number\">1</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> msg:</span><br><span class=\"line\">            records = &#123;&#125;</span><br><span class=\"line\">            records[config[<span class=\"string\">&#x27;topic_1&#x27;</span>]] = consumeRecord(consumer_1)[<span class=\"number\">0</span>]</span><br><span class=\"line\">            records[config[<span class=\"string\">&#x27;topic_2&#x27;</span>]] = consumeRecord(consumer_2)[<span class=\"number\">0</span>]</span><br><span class=\"line\">            records[config[<span class=\"string\">&#x27;topic_3&#x27;</span>]] = consumeRecord(consumer_3)[<span class=\"number\">0</span>]</span><br><span class=\"line\">            request.websocket.send(<span class=\"built_in\">str</span>(records).encode())  <span class=\"comment\"># 向客户端发送数据</span></span><br><span class=\"line\">            time.sleep(<span class=\"number\">0.5</span>)  <span class=\"comment\"># 每0.5秒发一次</span></span><br></pre></td></tr></table></figure>\n<p>重新整合字典的键后，将通过 WebSocket 传输到前端 HTML。 最后解析为 Json 格式进行可视化。<br>\n <code>from dwebsocket.decorators import accept_websocket,require_websocket</code></p>\n<h2 id=\"命令整合\"><a class=\"anchor\" href=\"#命令整合\">#</a> 命令整合</h2>\n<p>由于该项目涉及到的软件多，需要同时 / 相继运行多个命令，故写了 bat 批处理文件统筹运行</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo Preparing system</span><br><span class=\"line\">echo off    </span><br><span class=\"line\">rmdir /q /s %ZOOKEEPER_LOGS_PATH%</span><br><span class=\"line\">rmdir /q /s %KAFKA_LOGS_PATH%</span><br><span class=\"line\">timeout 1</span><br><span class=\"line\">echo Starting Zookeeper</span><br><span class=\"line\">start cmd /k %KAFKA_PATH%\\bin\\windows\\zookeeper-server-start.bat %KAFKA_PATH%\\config\\zookeeper.properties</span><br><span class=\"line\">timeout 5</span><br><span class=\"line\">echo Starting Kafka Server</span><br><span class=\"line\">start cmd /k %KAFKA_PATH%\\bin\\windows\\kafka-server-start.bat %KAFKA_PATH%\\config\\server.properties</span><br><span class=\"line\">timeout 5</span><br><span class=\"line\">echo Starting Kafka Producer</span><br><span class=\"line\">start cmd /k %ANACONDA_PATH%/python.exe %THIS_PATH%/kafka/realTimeDataCollector.py /k</span><br><span class=\"line\">timeout 1</span><br><span class=\"line\">echo Starting Spark as Consumer</span><br><span class=\"line\">start cmd /k %ANACONDA_PATH%/python.exe %THIS_PATH%/trading-bot-master/eval.py /trading-bot-master/data/train.csv --model-name model_double-dqn_GOOG_50 --debug  </span><br><span class=\"line\"></span><br><span class=\"line\">echo Starting web server</span><br><span class=\"line\">start cmd /k %ANACONDA_PATH%/python.exe %THIS_PATH%/server/manage.py runserver</span><br></pre></td></tr></table></figure>\n<p>为了促进一点点代码健壮性和可复用性，乐。也写了配置文件统一修改参数</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">params = &#123;</span><br><span class=\"line\">        <span class=\"comment\"># crypto setup</span></span><br><span class=\"line\">        <span class=\"string\">&#x27;currency_1&#x27;</span>: <span class=\"string\">&#x27;BTC&#x27;</span>, <span class=\"comment\"># bitcoin</span></span><br><span class=\"line\">        <span class=\"string\">&#x27;currency_2&#x27;</span>: <span class=\"string\">&#x27;ETH&#x27;</span>, <span class=\"comment\"># ethereum</span></span><br><span class=\"line\">        <span class=\"string\">&#x27;currency_3&#x27;</span>: <span class=\"string\">&#x27;LINK&#x27;</span>, <span class=\"comment\"># chainlink</span></span><br><span class=\"line\">        ...</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">config = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;kafka_broker&#x27;</span>: <span class=\"string\">&#x27;localhost:9092&#x27;</span>,</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h1 id=\"结果可视化\"><a class=\"anchor\" href=\"#结果可视化\">#</a> 结果可视化</h1>\n<p>为了展示数据，我们设计了一个网站来展示一些图表和信息。</p>\n<ol>\n<li>设置了几个旋转卡片来显示不同加密货币的信息。卡片的正面显示了加密货币的名称、实时价格和相应的时间点。背面是相应加密货币的介绍和网址链接。信息以秒为单位进行更新。更新速度和加密货币的数量可以调整。</li>\n</ol>\n<p><img data-src=\"/assets/stream_processing/cards.png\" alt=\"cards\" title=\"旋转卡片\"></p>\n<ol start=\"2\">\n<li>使用折线图显示强化学习模型的预测结果。x 轴表示对应的时间 (分 - 秒)。y 轴表示某种加密货币的实时值。由于我们输入的是窗口实时价格，它会根据概率计算输出下一个时间间隔的最佳动作，并给用户一些建议。一旦有下降的趋势，将会出现红色标志表示警告，提示卖出，而绿色标志这表示价格良好，可以买入。图像也以秒为单位进行更新。</li>\n</ol>\n<p><img data-src=\"/assets/stream_processing/graph.png\" alt=\"graph\" title=\"预测折线图\"></p>\n<ol start=\"3\">\n<li>使用 Tradingview API 在页面中嵌入了一个 JavaScript 应用程序，以显示有关许多加密货币的更多信息。实现更多的功能。</li>\n</ol>\n<p><img data-src=\"/assets/stream_processing/tradingview.png\" alt=\"tradingview\" title=\"Tradingview API\" height=\"40%\"></p>\n<p>以下是 demo 视频展示</p>\n<div class=\"media-container\"><div class=\"player\" data-type=\"video\" data-src='[{\"name\":\"demo\",\"url\":\"/assets/stream_processing/demo.mp4\"}]'></div></div>\n<p>由于要快速传输实时数据，因此前端和后端之间的响应交互必须及时。因此，WebSocket 被用来解决这个问题。</p>\n<p><img data-src=\"/assets/stream_processing/websocket.png\" alt=\"websocket\" title=\"中间件\"></p>\n<figure class=\"highlight javascript\"><figcaption><span>中间件websocket</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 判断浏览器是否支持WebSocket，目前应该所有的浏览器都支持了.....</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"string\">&#x27;WebSocket&#x27;</span> <span class=\"keyword\">in</span> <span class=\"variable language_\">window</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;你的浏览器支持 WebSocket&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 创建一个WebSocket对象：sk，并且建立与服务端的连接（服务端程序要跑着哦）</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> sk = <span class=\"keyword\">new</span> <span class=\"title class_\">WebSocket</span>(<span class=\"string\">&#x27;ws://&#x27;</span> + <span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">host</span> + <span class=\"string\">&#x27;/test/&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">// 向服务端发送消息</span></span><br><span class=\"line\">sk.<span class=\"property\">onopen</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;websocket connection successful...&#x27;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">var</span> l = [<span class=\"string\">&#x27;1&#x27;</span>, <span class=\"string\">&#x27;2&#x27;</span>, <span class=\"string\">&#x27;3&#x27;</span>];</span><br><span class=\"line\">    sk.<span class=\"title function_\">send</span>(<span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(l));</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">// 接收服务端的消息，主要的业务逻辑也在这里完成</span></span><br><span class=\"line\">sk.<span class=\"property\">onmessage</span> = <span class=\"keyword\">function</span> (<span class=\"params\">msg</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 业务逻辑</span></span><br><span class=\"line\">    <span class=\"comment\">// console.log(&#x27;from service message: &#x27;, msg.data);</span></span><br><span class=\"line\">    data = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">parse</span>(msg.<span class=\"property\">data</span>.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\&#x27;/g</span>, <span class=\"string\">&#x27;&quot;&#x27;</span>));</span><br><span class=\"line\">    $(<span class=\"string\">&quot;#BTC_currency&quot;</span>).<span class=\"title function_\">html</span>(data[<span class=\"string\">&quot;topic_BTC&quot;</span>][<span class=\"string\">&quot;currency&quot;</span>])</span><br><span class=\"line\">    $(<span class=\"string\">&quot;#BTC_amount&quot;</span>).<span class=\"title function_\">html</span>(data[<span class=\"string\">&quot;topic_BTC&quot;</span>][<span class=\"string\">&quot;amount&quot;</span>])</span><br><span class=\"line\">    $(<span class=\"string\">&quot;#BTC_time&quot;</span>).<span class=\"title function_\">html</span>(<span class=\"title function_\">timestampToTime</span>(data[<span class=\"string\">&quot;topic_BTC&quot;</span>][<span class=\"string\">&quot;time&quot;</span>]))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;from service message: &#x27;</span>, msg.<span class=\"property\">data</span>);</span><br><span class=\"line\">    <span class=\"comment\">// 由于服务端主动断开连接，这里也断开WebSocket连接</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (sk.<span class=\"property\">readyState</span> == <span class=\"title class_\">WebSocket</span>.<span class=\"property\">CLOSED</span>) sk.<span class=\"title function_\">close</span>();</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">// 完事就关闭WebSocket连接</span></span><br><span class=\"line\">sk.<span class=\"property\">onclose</span> = <span class=\"keyword\">function</span> (<span class=\"params\">msg</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&#x27;websocket connection close...&#x27;</span>);</span><br><span class=\"line\">    sk.<span class=\"title function_\">close</span>()</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"comment\">// 当WebSocket连接创建成功后，我们就可以向服务端发送数据了</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (sk.<span class=\"property\">readyState</span> == <span class=\"title class_\">WebSocket</span>.<span class=\"property\">OPEN</span>) sk.<span class=\"title function_\">onopen</span>();</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"还能做的一些事情\"><a class=\"anchor\" href=\"#还能做的一些事情\">#</a> 还能做的一些事情</h1>\n<ol>\n<li>\n<p>可以将所有的强化学习操作将被移植到 Spark Streaming。利用 Keras API 和 Spark MLlib，我们可以更好的去实现 ransform, pipelines and featurization，完全以 Streaming 的形式实现预测功能。</p>\n</li>\n<li>\n<p>可以使用其他工具来更好地在 Spark 中呈现模型。例如，Analytics Zoo 是一个在 Spark 上运行 TensorFlow 的平台。与基础设施、Spark 数据结构和管道集成。BigDL 是一个开源的分布式深度学习框架。从而实现分布式模型训练和评估。</p>\n</li>\n<li>\n<p>虽然我们尝试用 Kafka 和 Spark 来重现整个管道过程，但是分布式属性，这个最大的优势和特点，并没有表现出来。原因主要是我们只在一台计算机上部署应用程序。</p>\n<p>为了实现分布式的想法，在云平台托管应用程序将是一个不错的选择。在此之前，Docker 可以设置一个容器来打包应用程序。Kubernetes 更好。它可以管理一堆主机和节点。在每个节点中，它运行许多独立的 pod (容器集)，这些 pod 可以实现我们应用程序的组件，如数据库，网站服务器。</p>\n<p>一旦我们将 Kubernetes 部署在某个平台上，比如 Amazon EKS 或 Google GKE，它就可以创建一个集群来组织我们设置的所有节点，并构建一个控制面板来管理它们。在一定程度上实现了分布式特性。</p>\n<p>节点可以执行不同的指令。例如，不同节点可以异步处理不同类型的加密货币，从而减少数据更新的延迟。</p>\n<p>另一方面，多个节点可以继续运行训练过程，并通过实时性持续优化模型的性能。在不影响前端网页正常使用的情况下，逐步更换旧模型。</p>\n<p>当任何其他用户想要查看特定加密货币的预测结果时，特定的主机会提供相应的结果。Kafka 的分区配置也可以在多个节点中使用。</p>\n</li>\n</ol>\n",
            "tags": [
                "科研项目",
                "强化学习",
                "流处理",
                "Kafka",
                "Zookeeper",
                "Spark"
            ]
        },
        {
            "id": "http://example.com/projects/double_descent/",
            "url": "http://example.com/projects/double_descent/",
            "title": "探究不同场景下的双下降(Double Descent)现象",
            "date_published": "2022-05-07T16:00:00.000Z",
            "content_html": "<h1 id=\"背景介绍\"><a class=\"anchor\" href=\"#背景介绍\">#</a> 背景介绍</h1>\n<p>由于物理硬件算力的提升，基于较大规模神经网络的深度学习方式，因其令人满意的结果产出，成为这个时代的爆点研究方向。模型训练的好坏，除了正相关于模型本身隐藏层的构建，训练配置也至关重要</p>\n<p>朴素的思想是希望在可行的条件下，训练结果能在测试数据集中得到一个尽量趋近于完美的结果，并且这个结果可以有效的继承到测试数据集中</p>\n<p>然后，在为人熟知的传统结论里，模型的偏差和方差是一个<span class=\"red\">权衡问题 (trade-off)</span></p>\n<ul>\n<li>偏差是我们模型的平均预测值和我们试图预测的正确值之间的差异。高偏差模型很少关注训练数据，过度简化模型。从而导致训练和测试数据的高误差，这意味着模型在训练数据上的拟合度不够。</li>\n<li>方差是对给定数据点的模型预测的可变性，或是数据分布的评估值。具有高方差的模型非常关注训练数据，但对训练集中没有涵盖的新数据的概括能力差。因此，此类模型在训练数据上表现良好，但在测试数据上错误率很高，这意味着模型在训练数据上出现了过度拟合。</li>\n</ul>\n<p>由此，衍生出了模型训练的两个阶段：<span class=\"label primary\">欠拟合阶段</span>和<span class=\"label primary\">过拟合阶段</span>，常呈现 U 形图像，如下图所示</p>\n<p><img data-src=\"/assets/double_descent/u-curve.png\" alt=\"u-curve\" title=\"U形测试误差\"></p>\n<p>我们可以看到，训练数据上的小误差并不能保证测试数据上的高精度。虽然训练误差在整个训练过程中逐渐减小，但在欠拟合状态下，测试误差逐渐减小，而在过拟合状态下，测试误差逐渐增大</p>\n<p>然而，现代机器学习表明，测试误差不一定一直保持 U 形。当参数个数达到一定值时，测试误差依旧会减小。在整个测试过程中，误差曲线包含 2 条下降曲线。这种现象被称为<span class=\"red\"> “双下降”（Double Descent）</span></p>\n<p>这个项目就将研究，误差风险曲线的形状随<span class=\"label primary\">模型大小</span>、<span class=\"label primary\">训练次数</span>、<span class=\"label primary\">数据集</span>以及<span class=\"label primary\">其他训练操作</span>变化而产生的影响。包含实验与分析，往下看吧</p>\n<h1 id=\"为什么双下降会发生\"><a class=\"anchor\" href=\"#为什么双下降会发生\">#</a> 为什么双下降会发生</h1>\n<h2 id=\"泛化误差的分解\"><a class=\"anchor\" href=\"#泛化误差的分解\">#</a> 泛化误差的分解</h2>\n<p>在接下来的过程中，测试误差被分解为偏差和方差，并设置在线性模型中实现</p>\n<p>我们假设数据是在同一数据空间中独立生成的，因此所有数据都是独立同分布（i.i.d）的，这可以表示为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∼</mo><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">{x_i}\\sim{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span></span>。 我们希望使用以下等式计算输出 y</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mi>w</mi><mo>⋅</mo><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_{clean} = f(x_i) = w \\cdot x_i \n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.44445em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>然而，现实环境中不可避免地会包含一些噪声，因此真正的模型是干净数据和独立高斯噪声 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\epsilon_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 的组合，其中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>ϵ</mi><mi>i</mi></msub><mo>∼</mo><mrow><mi>N</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">{\\epsilon}_i\\sim{N(0,{\\sigma^ 2})}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">y_i = y_{clean} + {\\epsilon}_i\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7777700000000001em;vertical-align:-0.19444em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.58056em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>检验误差也称为泛化误差，可以通过最小二乘误差的期望值来计算。 如下式所示，其中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\hat{f}(x_i)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2078799999999998em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9578799999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span><span style=\"top:-3.26344em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.08332999999999999em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> 表示预测结果</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.24999999999999992em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>G</mi><mi>e</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>z</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>E</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mrow><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mi>i</mi></msub><mo>−</mo><mrow><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><msub><mi>ϵ</mi><mi>i</mi></msub><mo>+</mo><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>−</mo><mrow><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy=\"false\">[</mo><msubsup><mi>ϵ</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy=\"false\">]</mo><mo>+</mo><mi>E</mi><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>−</mo><mrow><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo><mo>+</mo><mn>2</mn><mo>∗</mo><mi>E</mi><mo stretchy=\"false\">[</mo><msub><mi>ϵ</mi><mi>i</mi></msub><mo>∗</mo><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>−</mo><mrow><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mo>+</mo><mi>E</mi><mo stretchy=\"false\">[</mo><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>−</mo><mrow><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo stretchy=\"false\">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>b</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo stretchy=\"false\">[</mo><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup><mo>+</mo><mi>v</mi><mi>a</mi><mi>r</mi><mo stretchy=\"false\">[</mo><mover accent=\"true\"><mi>f</mi><mo>^</mo></mover><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\nGeneralization Error &amp;= E[(y_i-{\\hat{f}(x_i)})^2]\\\\\n&amp;=E[(y_{clean}+{\\epsilon}_i-{\\hat{f}(x_i)})^2]\\\\\n&amp;=E[({\\epsilon}_i+(y_{clean}-{\\hat{f}(x_i)}))^2]\\\\\n&amp;=E[{\\epsilon}_i^2] + E[(y_{clean}-{\\hat{f}(x_i)})^2] + 2 * E[{\\epsilon}_i*(y_{clean}-{\\hat{f}(x_i)})]\\\\\n&amp;=\\sigma^2+ + E[(y_{clean}-{\\hat{f}(x_i)})^2]\\\\\n&amp;=\\sigma^2+bias[\\hat{f}(x_i)]^2+var[\\hat{f}(x_i)]^2\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:9.707279999999999em;vertical-align:-4.60364em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.103639999999999em;\"><span style=\"top:-7.145759999999999em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">G</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span></span></span><span style=\"top:-5.52788em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.909999999999999em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.2921199999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.6742399999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.9436400000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.60364em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.103639999999999em;\"><span style=\"top:-7.145759999999999em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9578799999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span><span style=\"top:-3.26344em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.08332999999999999em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span><span style=\"top:-5.52788em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9578799999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span><span style=\"top:-3.26344em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.08332999999999999em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span><span style=\"top:-3.909999999999999em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9578799999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span><span style=\"top:-3.26344em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.08332999999999999em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span><span style=\"top:-2.2921199999999993em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9578799999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span><span style=\"top:-3.26344em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.08332999999999999em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">ϵ</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9578799999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span><span style=\"top:-3.26344em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.08332999999999999em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span><span class=\"mclose\">)</span><span class=\"mclose\">]</span></span></span><span style=\"top:-0.6742399999999997em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\">+</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mopen\">[</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.33610799999999996em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9578799999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span><span style=\"top:-3.26344em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.08332999999999999em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span><span style=\"top:0.9436400000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9578799999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span><span style=\"top:-3.26344em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.08332999999999999em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mopen\">[</span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9578799999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span><span style=\"top:-3.26344em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.08332999999999999em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.19444em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641079999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.60364em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>上式让我们知道测试误差与偏差和方差之和有关。 风险曲线由偏差和方差权衡决定。这里，偏差是指数据分布与机器学习模型结果之间的差距，而方差是训练数据和测试数据之间模型性能的差异</p>\n<h2 id=\"偏差-方差曲线\"><a class=\"anchor\" href=\"#偏差-方差曲线\">#</a> 偏差 - 方差曲线</h2>\n<p>经典机器学习理论认为测试误差曲线应呈 U 形。一开始，偏差的下降幅度大于方差的上升幅度，从而导致风险曲线整体下降。继而，方差增加的速度快于偏差减少的速度，导致风险曲线增加。如图 1 所示</p>\n<div align=\"center\">\n    <img data-src=\"/assets/double_descent/classic_risk_curve.png\" alt=\"图片1\" width=\"40%\"/>\n    <img data-src=\"/assets/double_descent/modern_risk_curve.png\" alt=\"图片2\" width=\"40%\"/>\n</div>\n<p>然而，现代机器学习理论认为，随着模型复杂度的增加，方差曲线会先增大，然后减小。在第一阶段，偏差减小的速度快于方差增加的速度，从而导致泛化误差的下降。在下一阶段，偏差的减少速度慢于方差的增加速度。导致泛化误差曲线增加。最后，在第三阶段，偏差和方差都下降，从而触发测试误差的下降。如图 2 所示</p>\n<h1 id=\"实验\"><a class=\"anchor\" href=\"#实验\">#</a> 实验</h1>\n<h2 id=\"实验设置\"><a class=\"anchor\" href=\"#实验设置\">#</a> 实验设置</h2>\n<h3 id=\"损失函数\"><a class=\"anchor\" href=\"#损失函数\">#</a> 损失函数</h3>\n<p>传统的损失函数计算方法采取均方误差 (MSE)。然而在深度神经网络中，sigmoid 函数作为激活函数可能会导致梯度消失。交叉熵用于弥补 MSE 的不足。常与 softmax 函数一起使用。获得数据被预测为每个类别的概率</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>C</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>E</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>−</mo><mo stretchy=\"false\">[</mo><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>P</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">Cross Entropy = - [label * log(P) + (1-label) * log(1-P)]\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mclose\">]</span></span></span></span></span></p>\n<p>其中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">label</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span> 表示数据的标签，其中正样本的标签为 1，负样本的标签为 0。<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span> 表示数据被预测为正样本的概率</p>\n<p>上述为二分类时的情况，在多分类问题中，交叉熵的计算如下等式所示</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>C</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>E</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><msub><mi>P</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Cross Entropy = - \\sum_{i=1}^{n} label_i * log(P_i)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.929066em;vertical-align:-1.277669em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6513970000000002em;\"><span style=\"top:-1.872331em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.050005em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3000050000000005em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.277669em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">e</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>其中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>n</mi></mrow><annotation encoding=\"application/x-tex\">n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">n</span></span></span></span> 表示数据集的标签数量。 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">label_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">e</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 表示如果数据的类别为<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span>，则 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">label_i=1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">e</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span>，否则 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">label_i=0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.84444em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">e</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span></span></span></span>。 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">P_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.83333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> 表示数据被预测为标签 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi></mrow><annotation encoding=\"application/x-tex\">i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.65952em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">i</span></span></span></span> 的概率。</p>\n<h3 id=\"模型\"><a class=\"anchor\" href=\"#模型\">#</a> 模型</h3>\n<p>Pytorch 被用于实现以下系列架构。</p>\n<p>在 Fashion MNIST 数据集中，我们使用 2 层 CNN 结构，每个卷积层中的滤波器数量为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> 和 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">2w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span>，其中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> 表示模型的宽度。 滤波器的内核大小和步幅选择为 <span class=\"label primary\">3</span> 和 <span class=\"label primary\">1</span></p>\n<p>并利用 padding 保持尺寸相同。在每个卷积层之后，我们使用 BatchNormalization、ReLu 和 2x2 的 MaxPooling 将每个维度的大小下采样 2 个单位。在这 2 个卷积层之后，我们使用线性层将输出转换为大小 10</p>\n<p>在 Cifar10 实验中，我们分别选择 3 层、5 层和 7 层的 CNN 模型结构。 对于每个卷积层，我们应用内核大小 = 3、步长 = 1 和填充 = 1 的滤波器。在每个卷积层之后，经过 BatchNormzliation、ReLU 和 MaxPooling。 卷积层宽度设计为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>w</mi><mo separator=\"true\">,</mo><mn>2</mn><mi>w</mi><mo separator=\"true\">,</mo><mn>4</mn><mi>w</mi><mo separator=\"true\">,</mo><mn>8</mn><mi>w</mi><mo separator=\"true\">,</mo><mo>⋯</mo><mtext> </mtext><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[w,2w,4w,8w,\\cdots]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">4</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">8</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"minner\">⋯</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mclose\">]</span></span></span></span>。 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> 是作为一个可变参数引入的，用于在训练时控制模型的宽度和复杂性，这就是我们所有实验中所谓的 “宽度”。 MaxPooling 的池化大小和步长为 2。最后添加一个大小为 4 的线性层和 ReLU。</p>\n<h3 id=\"训练细节和超参数\"><a class=\"anchor\" href=\"#训练细节和超参数\">#</a> 训练细节和超参数</h3>\n<p><strong>数据增强</strong><br>\n在使用数据增强的实验中，除了 <strong>RandomCrop</strong> 和 <strong>RandomHorizontalFlip</strong> 这样的常见变换之外。 我们还将噪声引入到标签和特征数据中</p>\n<p>更具体地说，对于标签噪声，我们随机选择一定比例的数据（代表标签噪声所占的比例为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x%</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>）。 将正确的标签更改为错误的结果。 例如，在 Cifar10 中，所有目标标签都设置在 0-9 的范围内。 如果某个数据的正确标签为 5，我们可以将其修改为 0-9 中的任何其他随机数。 从而模拟标签噪声的场景</p>\n<p>对于特征噪声，在图像分类情况下，我们对原始图像的每个 0-255 像素值引入高斯噪声</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>G</mi><mi>a</mi><mi>u</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>a</mi><mi>n</mi><mi>N</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>e</mi><mo>=</mo><mi>A</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>u</mi><mi>d</mi><mi>e</mi><mo>⋅</mo><mi>N</mi><mo stretchy=\"false\">(</mo><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mo separator=\"true\">,</mo><mi>v</mi><mi>a</mi><mi>r</mi><mi>i</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">Gaussian Noise = Amplitude\\cdot N(mean, variance)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">G</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">n</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">e</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>然后将数据特征标准化到 0-1 的范围</p>\n<p>在添加标签噪声和特征噪声的实验中，给定训练样本的所有被增强的标签都被赋予相同的数值。 不同 epochs 添加的高斯噪声保持一致。</p>\n<p><strong>优化器：</strong></p>\n<ul>\n<li>\n<p><strong>SGD:</strong><br>\n 对于 Cifar10 数据集，使用 Inverse Square Root Scheduler，初始学习率 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>r</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding=\"application/x-tex\">lr=0.1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">1</span></span></span></span>。 我们每 512 个梯度步更新一次学习率。 没有使用 Momentum。 对于 Fashion MNIST 数据集，一开始引入的学习率为 0.01。 随着 epoch 的增加，学习率下降为 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0.01</mn><msqrt><mfrac><mn>1</mn><mrow><mi>e</mi><mi>p</mi><mi>o</mi><mi>c</mi><mi>h</mi></mrow></mfrac></msqrt></mrow><annotation encoding=\"application/x-tex\">0.01\\sqrt{\\frac{1}{epoch}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.8400000000000003em;vertical-align:-0.6729999999999999em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">1</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1670000000000003em;\"><span class=\"svg-align\" style=\"top:-3.8em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.845108em;\"><span style=\"top:-2.6550000000000002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\">h</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.481108em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.127em;\"><span class=\"pstrut\" style=\"height:3.8em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.8800000000000001em;\"><svg width='400em' height='1.8800000000000001em' viewBox='0 0 400000 1944' preserveAspectRatio='xMinYMin slice'><path d='M983 90\nl0 -0\nc4,-6.7,10,-10,18,-10 H400000v40\nH1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7\ns-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744\nc-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30\nc26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722\nc56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5\nc53.7,-170.3,84.5,-266.8,92.5,-289.5z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6729999999999999em;\"><span></span></span></span></span></span></span></span></span>。 设置动量为 0.95。</p>\n</li>\n<li>\n<p><strong>Stochastic Gradient Langevin Dynamics(SGLD):</strong><br>\nSGLD 是一种优化方法，其基本思想是在梯度下降过程中注入噪声。<br>\n它与随机梯度下降（SGD）类似，只不过它在梯度下降更新参数时结合了噪声</p>\n</li>\n</ul>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>t</mi></msub><mo>−</mo><mi>L</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo>⋅</mo><mi mathvariant=\"normal\">∇</mi><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msqrt><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><mi>L</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow></msqrt><mo>⋅</mo><msqrt><mrow><mn>2</mn><mo>⋅</mo><mi>T</mi></mrow></msqrt><mo>⋅</mo><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">x_{t+1} = x_t - LearningRate \\cdot \\nabla f(x) + \\sqrt{1/LearningRate} \\cdot \\sqrt{2 \\cdot T} \\cdot w\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.638891em;vertical-align:-0.208331em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.301108em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.208331em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.73333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2805559999999999em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∇</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.24em;vertical-align:-0.25612499999999994em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.983875em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\">1</span><span class=\"mord\">/</span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-2.9438750000000002em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg width='400em' height='1.28em' viewBox='0 0 400000 1296' preserveAspectRatio='xMinYMin slice'><path d='M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.25612499999999994em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.04em;vertical-align:-0.06445999999999996em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9755400000000001em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span><span style=\"top:-2.93554em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.06445999999999996em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span></span></p>\n<p>其中 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">LearningRate</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span></span></span></span> 表示梯度下降的学习率。 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8888799999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span> 表示目标函数，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span> 称为温度，通常取值 0.1 或 0.01。 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> 表示高斯噪声</p>\n<p><strong>初始化和正则化：</strong><br>\n方差初始化为 Pytorch 的默认设置。除了某些明确的情况外，不存在例如 weight decay 和 dropout 这样的正则化</p>\n<p><strong>Batch Size：</strong><br>\nCifar10 的 Batch Size 为 128。Fashion MNIST 的 Batch Size 为 100</p>\n<p 测试准确度=\"\"><strong>训练误差和测试误差：</strong><br>\n前者等于 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>−</mo><mtext mathvariant=\"italic\">训练精度</mtext></mrow><annotation encoding=\"application/x-tex\">1-\\textit{训练精度}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.72777em;vertical-align:-0.08333em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord text\"><span class=\"mord textit cjk_fallback\">训练精度</span></span></span></span></span>（每个 epoch 之后基于训练集测试模型的性能）。 后者等于 1-\\textit</p>\n<h1 id=\"实验结果\"><a class=\"anchor\" href=\"#实验结果\">#</a> 实验结果</h1>\n<h2 id=\"model-wise-double-descent\"><a class=\"anchor\" href=\"#model-wise-double-descent\">#</a> Model-wise Double Descent</h2>\n<p>我们在自己的实验中重现了宽度方向的双下降现象。 与论文中提到的在 Cifar10、Cifar100 和 MNIST 数据集上进行的实验不同，我们尝试在 Fashion MNIST 数据集上重现宽度方向双下降图。 再现的结果如图 \\ref {fig:widthdd} 所示。</p>\n<p><img data-src=\"/assets/double_descent/width_double_descent.png\" alt=\"Model-wise Double Descent\" title=\"带有 20% 标签噪声的，基于 Fashion MNIST 数据集的Model-wise Double Descent\"></p>\n<h2 id=\"epoch-wise-double-descent\"><a class=\"anchor\" href=\"#epoch-wise-double-descent\">#</a> Epoch-wise Double Descent</h2>\n<p>在我们对 Fashion MNIST 进行的具有各种 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> 选择的实验中，我们将这些不同大小的模型分别训练 1000 个 epoch。 根据结果，我们将这些模型大小分为四个不同的区域，其特点是在 1000 个 epoch 训练中具有不同的测试误差性能。</p>\n<p>每个区域的模型大小的具体图如图 \\ref {fig:epochwidth} 所示。 首先，当模型宽度很小时，不会发生过拟合。 然后当模型宽度变大时，过拟合问题就会出现，并且在某个区域变得越来越严重。 在该区域之后，过度拟合开始变弱，并且在训练结束时，测试误差趋于稳定。 当我们进入最后一个区域后，模型规模确实很大，过拟合的程度比过拟合峰值前后要小得多，测试误差甚至趋于缓慢下降。<br>\n\\<br>\n 因此，当用于训练的模型足够大时，随着 epoch 数量的增加，会出现双下降现象。 在我们的实验中，我们使用 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo>=</mo><mn>512</mn></mrow><annotation encoding=\"application/x-tex\">w = 512</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">5</span><span class=\"mord\">1</span><span class=\"mord\">2</span></span></span></span> 的 2 层 CNN 在 Fashion MNIST 数据集上重现了这种现象。 CNN 更具体的设置在实验部分展示。 结果如图 \\ref {fig:epochdd} 所示。</p>\n<div align=\"center\">\n    <img data-src=\"/assets/double_descent/w1epoch_double_descent.png\" alt=\"图片1\" width=\"30%\"/>\n    <img data-src=\"/assets/double_descent/w10epoch_double_descent.png\" alt=\"图片2\" width=\"30%\"/>\n    <img data-src=\"/assets/double_descent/w62epoch_double_descent.png\" alt=\"图片3\" width=\"30%\"/>\n    <img data-src=\"/assets/double_descent/w308epoch_double_descent.png\" alt=\"图片4\" width=\"30%\"/>\n    <span class=\"image-info\">4个不同类型模型尺寸的测试误差</span>\n</div>\n",
            "tags": [
                "科研项目",
                "机器学习",
                "Python"
            ]
        },
        {
            "id": "http://example.com/neural_network/transformer/",
            "url": "http://example.com/neural_network/transformer/",
            "title": "Transformer 备忘录",
            "date_published": "2022-04-12T16:00:00.000Z",
            "content_html": "<ol>\n<li>\n<p>为什么选择 Transformer<br>\nNLP 任务需要编码器抽取上下文的特征<br>\n上下文的语义很重要，每个词的语义和上下文强相关<br>\n方向<br>\n RNN 只能对句子进行单向的编码<br>\n CNN 只能对短句子进行编码<br>\n Transformer 可以双向编码，也抽取长距离的特征<br>\n顺序（词的位置变换了会产生不同的意思）<br>\n速度<br>\n RNN 无法并行处理序列，其他都行</p>\n</li>\n<li>\n<p>多头自注意力模块<br>\n首先对输入进行 projection，得到 QKV 三个矩阵<br>\n（tf 对输入进行了降维 (B, L, D) -&gt; (B<em>L, D)）<br>\n初始化三个 dense 层 (B</em>L, D) -&gt; (B<em>L, N</em>H) N 为 attention 模块的数量，H 为长度<br>\n为什么要在这个进行投影呢？<br>\n若不投影，在之后的注意力模块中，相同的 Q 和 V 会进行点积，使得 attention 矩阵对角线的分数特别高（自己和自己的分数？），每个词的注意力都在自己身上，无法获得上下文的关系。所以需要将 QKV 投影到不同的空间中，增加多样性。</p>\n<p>之后进行 reshape, (B<em>L, N</em>H) -&gt; (B, N, L, H)<br>\n 为什么要用多注意力头呢？<br>\n希望不同的注意力头学到不同的特征，和 CNN 里的 multi-channel 类似</p>\n<p>多不同的注意力头进行点积、转置<br>\n为什么要用乘法呢？（为什么不用加性 attention 呢？）<br>\n在 GPU 的场景下，矩阵乘法的效率更高，随着 D 的增大，加性 attention 的效果会更好<br>\n为什么要除以√D 呢？<br>\n两个的矩阵相乘之后方差会变大，使得有些词注意力很大有些很小，经过 softmax 之后再求导会导致梯度很小，不利于优化，除了之后可以平滑一下。e.g. N (0, √d)*N (0, √d) = N (0, d) -&gt; / √d -&gt; N (0, 1)。</p>\n<p>乘 mask 矩阵（正常 token 的值为 0，要丢弃的 token 值为 1w）使得正常 token 的值维持原状，被丢弃的 token 值很小。使得进过 softmax 之后，不想要被注意的值无限趋于 0</p>\n<p>进行 softmax 归一化得到注意力分数</p>\n<p>用 V 矩阵和注意力分数进行加权，再把不同头的分数合并起来</p>\n</li>\n<li>\n<p>残差连接 &amp; Normalisation<br>\n 相加操作与 ResNet 相似，相当于在求导时加了一个恒等项，减少梯度消失的问题</p>\n<p>Layer_Norm<br>\n 提升神经网络的泛化性<br>\n（数据的分布对模型可能会有很大的影响）<br>\n所以需要将隐藏层的输出都归一化成均值为 0 方差为 1 的分布<br>\n更好的利用模型在训练集中收获的知识<br>\n norm 放在激活函数之前，避免数据落入饱和区，减少梯度消失的问题<br>\n（实际操作时会初始化一个新的均值和方差，调整分布，增加多样性）</p>\n<pre><code> NLP的序列是变长的，Batch_Norm在对不同样本的同一个位置去做归一化时，无法获得真实分布的统计值。\n Layer_Norm会对同一个样本每一个位置的不同特征做归一化\n\n\n \n\n Normalisation可以放在不同的地方\n     Post-LayerNorm先做残差再归一化\n         保持主干网络的方差比较稳定，使模型泛化能力更强。\n         但把恒等的路径放在norm里，会导致模型更难收敛。\n     Pre-LayerNorm先归一化再做残差\n         更容易收敛，但只是增加了网络的宽度而不是深度，效果没有前者好。\n</code></pre>\n</li>\n<li>\n<p>Positionwise FFN (Feed Forward Network)<br>\n 提供了非线性变换，提升拟合能力 (1*1 卷积核的全连接层)。<br>\n激活层从 ReLU 变成了 GeLU，引入了正则的思想，越小的值越可能被丢弃掉，相当于 ReLU 和 dropout 的结合。<br>\ntanh 和 sigmoid 的双边区域会饱和，导致导数趋于 0，有梯度消失的问题。</p>\n</li>\n</ol>\n",
            "tags": [
                "神经网络",
                "自然语言处理"
            ]
        },
        {
            "id": "http://example.com/travel/xinjiang/xinjiang/",
            "url": "http://example.com/travel/xinjiang/xinjiang/",
            "title": "跨越山海|新疆自驾毕业旅行",
            "date_published": "2021-06-19T16:00:00.000Z",
            "content_html": "",
            "tags": [
                "旅行日志",
                "旅行"
            ]
        }
    ]
}