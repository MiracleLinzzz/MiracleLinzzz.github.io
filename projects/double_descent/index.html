<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="自是白衣卿相的博客" href="http://m1racle.cn/rss.xml"><link rel="alternate" type="application/atom+xml" title="自是白衣卿相的博客" href="http://m1racle.cn/atom.xml"><link rel="alternate" type="application/json" title="自是白衣卿相的博客" href="http://m1racle.cn/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="机器学习,Python"><link rel="canonical" href="http://m1racle.cn/projects/double_descent/"><title>探究不同场景下的双下降(Double Descent)现象 - 科研项目 | Miracle = 自是白衣卿相的博客</title><meta name="generator" content="Hexo 7.1.1"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">探究不同场景下的双下降(Double Descent)现象</h1><div class="meta"><span class="item" title="创建时间：2022-05-08 00:00:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-05-08T00:00:00+08:00">2022-05-08</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>10k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>9 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Miracle</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://MiracleLinzzz.github.io/picx-images-hosting/DSCF9034.7dvb47yhgu00.webp"></li><li class="item" data-background-image="https://MiracleLinzzz.github.io/picx-images-hosting/DSCF9483.5t4dlfsodp80.webp"></li><li class="item" data-background-image="https://MiracleLinzzz.github.io/picx-images-hosting/DSCF9318.5bk8leyb8mg0.webp"></li><li class="item" data-background-image="https://MiracleLinzzz.github.io/picx-images-hosting/DSCF7828.3m4xmn8n4aa0.webp"></li><li class="item" data-background-image="https://MiracleLinzzz.github.io/picx-images-hosting/DSCF8835.62opfc0lrwg0.webp"></li><li class="item" data-background-image="https://MiracleLinzzz.github.io/picx-images-hosting/DSCF9245.42ll7bij8sg0.webp"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/projects/" itemprop="item" rel="index" title="分类于 科研项目"><span itemprop="name">科研项目</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://m1racle.cn/projects/double_descent/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Miralce"><meta itemprop="description" content=", "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="自是白衣卿相的博客"></span><div class="body md" itemprop="articleBody"><h1 id="背景介绍"><a class="anchor" href="#背景介绍">#</a> 背景介绍</h1><p>由于物理硬件算力的提升，基于较大规模神经网络的深度学习方式，因其令人满意的结果产出，成为这个时代的爆点研究方向。模型训练的好坏，除了正相关于模型本身隐藏层的构建，训练配置也至关重要</p><p>朴素的思想是希望在可行的条件下，训练结果能在测试数据集中得到一个尽量趋近于完美的结果，并且这个结果可以有效的继承到测试数据集中</p><p>然后，在为人熟知的传统结论里，模型的偏差和方差是一个<span class="red">权衡问题 (trade-off)</span></p><ul><li>偏差是我们模型的平均预测值和我们试图预测的正确值之间的差异。高偏差模型很少关注训练数据，过度简化模型。从而导致训练和测试数据的高误差，这意味着模型在训练数据上的拟合度不够。</li><li>方差是对给定数据点的模型预测的可变性，或是数据分布的评估值。具有高方差的模型非常关注训练数据，但对训练集中没有涵盖的新数据的概括能力差。因此，此类模型在训练数据上表现良好，但在测试数据上错误率很高，这意味着模型在训练数据上出现了过度拟合。</li></ul><p>由此，衍生出了模型训练的两个阶段：<span class="label primary">欠拟合阶段</span>和<span class="label primary">过拟合阶段</span>，常呈现 U 形图像，如下图所示</p><div align="center"><img data-src="/assets/double_descent/u-curve.png" alt="图片1" width="50%" title="经典机器学习中的风险曲线" display="inline"> <span class="image-info">图1 U形测试误差</span></div>我们可以看到，训练数据上的小误差并不能保证测试数据上的高精度。虽然训练误差在整个训练过程中逐渐减小，但在欠拟合状态下，测试误差逐渐减小，而在过拟合状态下，测试误差逐渐增大<p>然而，现代机器学习表明，测试误差不一定一直保持 U 形。当参数个数达到一定值时，测试误差依旧会减小。在整个测试过程中，误差曲线包含 2 条下降曲线。这种现象被称为<span class="red"> “双下降”（Double Descent）</span></p><p>这个项目就将研究，误差风险曲线的形状随<span class="label primary">模型大小</span>、<span class="label primary">训练次数</span>、<span class="label primary">数据集</span>以及<span class="label primary">其他训练操作</span>变化而产生的影响。包含实验与分析，往下看吧</p><h1 id="为什么双下降会发生"><a class="anchor" href="#为什么双下降会发生">#</a> 为什么双下降会发生</h1><h2 id="泛化误差的分解"><a class="anchor" href="#泛化误差的分解">#</a> 泛化误差的分解</h2><p>在接下来的过程中，测试误差被分解为偏差和方差，并设置在线性模型中实现</p><p>我们假设数据是在同一数据空间中独立生成的，因此所有数据都是独立同分布（i.i.d）的，这可以表示为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>∼</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">{x_i}\sim{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">D</span></span></span></span></span>。 我们希望使用以下等式计算输出 y</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mi>w</mi><mo>⋅</mo><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_{clean} = f(x_i) = w \cdot x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.44445em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p>然而，现实环境中不可避免地会包含一些噪声，因此真正的模型是干净数据和独立高斯噪声 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\epsilon_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">ϵ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 的组合，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mi>i</mi></msub><mo>∼</mo><mrow><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">{\epsilon}_i\sim{N(0,{\sigma^ 2})}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i = y_{clean} + {\epsilon}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p>检验误差也称为泛化误差，可以通过最小二乘误差的期望值来计算。 如下式所示，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\hat{f}(x_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2078799999999998em;vertical-align:-.25em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9578799999999998em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10764em">f</span></span></span><span style="top:-3.26344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.08332999999999999em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> 表示预测结果</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>G</mi><mi>e</mi><mi>n</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>z</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>E</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mrow><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mi>i</mi></msub><mo>−</mo><mrow><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><mo stretchy="false">(</mo><msub><mi>ϵ</mi><mi>i</mi></msub><mo>+</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>−</mo><mrow><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy="false">[</mo><msubsup><mi>ϵ</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="false">]</mo><mo>+</mo><mi>E</mi><mo stretchy="false">[</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>−</mo><mrow><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">]</mo><mo>+</mo><mn>2</mn><mo>∗</mo><mi>E</mi><mo stretchy="false">[</mo><msub><mi>ϵ</mi><mi>i</mi></msub><mo>∗</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>−</mo><mrow><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mo>+</mo><mi>E</mi><mo stretchy="false">[</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>c</mi><mi>l</mi><mi>e</mi><mi>a</mi><mi>n</mi></mrow></msub><mo>−</mo><mrow><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>b</mi><mi>i</mi><mi>a</mi><mi>s</mi><mo stretchy="false">[</mo><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mn>2</mn></msup><mo>+</mo><mi>v</mi><mi>a</mi><mi>r</mi><mo stretchy="false">[</mo><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><msup><mo stretchy="false">]</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} Generalization Error &amp;= E[(y_i-{\hat{f}(x_i)})^2]\\ &amp;=E[(y_{clean}+{\epsilon}_i-{\hat{f}(x_i)})^2]\\ &amp;=E[({\epsilon}_i+(y_{clean}-{\hat{f}(x_i)}))^2]\\ &amp;=E[{\epsilon}_i^2] + E[(y_{clean}-{\hat{f}(x_i)})^2] + 2 * E[{\epsilon}_i*(y_{clean}-{\hat{f}(x_i)})]\\ &amp;=\sigma^2+ + E[(y_{clean}-{\hat{f}(x_i)})^2]\\ &amp;=\sigma^2+bias[\hat{f}(x_i)]^2+var[\hat{f}(x_i)]^2 \end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.707279999999999em;vertical-align:-4.60364em"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.103639999999999em"><span style="top:-7.145759999999999em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">G</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:.04398em">z</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal">o</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:.02778em">r</span></span></span><span style="top:-5.52788em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-3.909999999999999em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-2.2921199999999993em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:-.6742399999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span><span style="top:.9436400000000003em"><span class="pstrut" style="height:3em"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.60364em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.103639999999999em"><span style="top:-7.145759999999999em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">[</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9578799999999998em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10764em">f</span></span></span><span style="top:-3.26344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.08332999999999999em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span style="top:-5.52788em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">[</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9578799999999998em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10764em">f</span></span></span><span style="top:-3.26344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.08332999999999999em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span style="top:-3.909999999999999em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">[</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathnormal">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9578799999999998em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10764em">f</span></span></span><span style="top:-3.26344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.08332999999999999em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span style="top:-2.2921199999999993em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">[</span><span class="mord"><span class="mord"><span class="mord mathnormal">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-2.4530000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.247em"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">[</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9578799999999998em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10764em">f</span></span></span><span style="top:-3.26344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.08332999999999999em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">[</span><span class="mord"><span class="mord"><span class="mord mathnormal">ϵ</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9578799999999998em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10764em">f</span></span></span><span style="top:-3.26344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.08332999999999999em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mclose">)</span><span class="mclose">]</span></span></span><span style="top:-.6742399999999997em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord">+</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">[</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9578799999999998em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10764em">f</span></span></span><span style="top:-3.26344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.08332999999999999em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span style="top:.9436400000000003em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathnormal">b</span><span class="mord mathnormal">i</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mopen">[</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9578799999999998em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10764em">f</span></span></span><span style="top:-3.26344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.08332999999999999em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mopen">[</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9578799999999998em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.10764em">f</span></span></span><span style="top:-3.26344em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-.08332999999999999em"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.19444em"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8641079999999999em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.60364em"><span></span></span></span></span></span></span></span></span></span></span></span></p><p>上式让我们知道测试误差与偏差和方差之和有关。 风险曲线由偏差和方差权衡决定。这里，偏差是指数据分布与机器学习模型结果之间的差距，而方差是训练数据和测试数据之间模型性能的差异</p><h2 id="偏差-方差曲线"><a class="anchor" href="#偏差-方差曲线">#</a> 偏差 - 方差曲线</h2><p>经典机器学习理论认为测试误差曲线应呈 U 形。一开始，偏差的下降幅度大于方差的上升幅度，从而导致风险曲线整体下降。继而，方差增加的速度快于偏差减少的速度，导致风险曲线增加。如图 1 所示</p><div align="center"><img data-src="/assets/double_descent/classic_risk_curve.png" alt="图片1" width="40%" title="经典机器学习中的风险曲线" display="inline-block"> <img data-src="/assets/double_descent/modern_risk_curve.png" alt="图片2" width="40%" title="现代机器学习中的风险曲线" display="inline-block"> <span class="image-info">图2 风险曲线</span></div><p>然而，现代机器学习理论认为，随着模型复杂度的增加，方差曲线会先增大，然后减小。在第一阶段，偏差减小的速度快于方差增加的速度，从而导致泛化误差的下降。在下一阶段，偏差的减少速度慢于方差的增加速度。导致泛化误差曲线增加。最后，在第三阶段，偏差和方差都下降，从而触发测试误差的下降。如图 2 所示</p><h1 id="实验"><a class="anchor" href="#实验">#</a> 实验</h1><h2 id="实验设置"><a class="anchor" href="#实验设置">#</a> 实验设置</h2><h3 id="损失函数"><a class="anchor" href="#损失函数">#</a> 损失函数</h3><p>传统的损失函数计算方法采取均方误差 (MSE)。然而在深度神经网络中，sigmoid 函数作为激活函数可能会导致梯度消失。交叉熵用于弥补 MSE 的不足。常与 softmax 函数一起使用。获得数据被预测为每个类别的概率</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>C</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>E</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>−</mo><mo stretchy="false">[</mo><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>P</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">Cross Entropy = - [label * log(P) + (1-label) * log(1-P)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">−</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mclose">)</span><span class="mclose">]</span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">label</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:.01968em">l</span></span></span></span> 表示数据的标签，其中正样本的标签为 1，负样本的标签为 0。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">P</span></span></span></span> 表示数据被预测为正样本的概率</p><p>上述为二分类时的情况，在多分类问题中，交叉熵的计算如下等式所示</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>C</mi><mi>r</mi><mi>o</mi><mi>s</mi><mi>s</mi><mi>E</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>p</mi><mi>y</mi><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub><mo>∗</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mi>P</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Cross Entropy = - \sum_{i=1}^{n} label_i * log(P_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.07153em">C</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.03588em">y</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em"></span><span class="mord">−</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em"><span style="top:-1.872331em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.01968em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span> 表示数据集的标签数量。 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">label_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.01968em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 表示如果数据的类别为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span>，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">label_i=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.01968em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>，否则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>a</mi><mi>b</mi><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">label_i=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.01968em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span>。 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 表示数据被预测为标签 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.65952em;vertical-align:0"></span><span class="mord mathnormal">i</span></span></span></span> 的概率。</p><h3 id="模型"><a class="anchor" href="#模型">#</a> 模型</h3><p>Pytorch 被用于实现以下系列架构。</p><p>在 Fashion MNIST 数据集中，我们使用 2 层 CNN 结构，每个卷积层中的滤波器数量为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>w</mi></mrow><annotation encoding="application/x-tex">2w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span> 表示模型的宽度。 滤波器的内核大小和步幅选择为 <span class="label primary">3</span> 和 <span class="label primary">1</span></p><p>并利用 padding 保持尺寸相同。在每个卷积层之后，我们使用 BatchNormalization、ReLu 和 2x2 的 MaxPooling 将每个维度的大小下采样 2 个单位。在这 2 个卷积层之后，我们使用线性层将输出转换为大小 10</p><p>在 Cifar10 实验中，我们分别选择 3 层、5 层和 7 层的 CNN 模型结构。 对于每个卷积层，我们应用内核大小 = 3、步长 = 1 和填充 = 1 的滤波器。在每个卷积层之后，经过 BatchNormzliation、ReLU 和 MaxPooling。 卷积层宽度设计为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>w</mi><mo separator="true">,</mo><mn>2</mn><mi>w</mi><mo separator="true">,</mo><mn>4</mn><mi>w</mi><mo separator="true">,</mo><mn>8</mn><mi>w</mi><mo separator="true">,</mo><mo>⋯</mo><mtext></mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[w,2w,4w,8w,\cdots]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">8</span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mclose">]</span></span></span></span>。 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span> 是作为一个可变参数引入的，用于在训练时控制模型的宽度和复杂性，这就是我们所有实验中所谓的 “宽度”。 MaxPooling 的池化大小和步长为 2。最后添加一个大小为 4 的线性层和 ReLU。</p><h3 id="训练细节和超参数"><a class="anchor" href="#训练细节和超参数">#</a> 训练细节和超参数</h3><p><strong>数据增强</strong><br>在使用数据增强的实验中，除了 <strong>RandomCrop</strong> 和 <strong>RandomHorizontalFlip</strong> 这样的常见变换之外。 我们还将噪声引入到标签和特征数据中</p><p>更具体地说，对于标签噪声，我们随机选择一定比例的数据（代表标签噪声所占的比例为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">x\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.80556em;vertical-align:-.05556em"></span><span class="mord mathnormal">x</span><span class="mord">%</span></span></span></span>）。 将正确的标签更改为错误的结果。 例如，在 Cifar10 中，所有目标标签都设置在 0-9 的范围内。 如果某个数据的正确标签为 5，我们可以将其修改为 0-9 中的任何其他随机数。 从而模拟标签噪声的场景</p><p>对于特征噪声，在图像分类情况下，我们对原始图像的每个 0-255 像素值引入高斯噪声</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>G</mi><mi>a</mi><mi>u</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>a</mi><mi>n</mi><mi>N</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>e</mi><mo>=</mo><mi>A</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>u</mi><mi>d</mi><mi>e</mi><mo>⋅</mo><mi>N</mi><mo stretchy="false">(</mo><mi>m</mi><mi>e</mi><mi>a</mi><mi>n</mi><mo separator="true">,</mo><mi>v</mi><mi>a</mi><mi>r</mi><mi>i</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Gaussian Noise = Amplitude\cdot N(mean, variance)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal">G</span><span class="mord mathnormal">a</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mord mathnormal">o</span><span class="mord mathnormal">i</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">A</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">i</span><span class="mord mathnormal">t</span><span class="mord mathnormal">u</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord mathnormal">e</span><span class="mclose">)</span></span></span></span></span></p><p>然后将数据特征标准化到 0-1 的范围</p><p>在添加标签噪声和特征噪声的实验中，给定训练样本的所有被增强的标签都被赋予相同的数值。 不同 epochs 添加的高斯噪声保持一致。</p><p><strong>优化器：</strong></p><ul><li><p><strong>SGD:</strong><br>对于 Cifar10 数据集，使用 Inverse Square Root Scheduler，初始学习率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>r</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">lr=0.1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span></span></span></span>。 我们每 512 个梯度步更新一次学习率。 没有使用 Momentum。 对于 Fashion MNIST 数据集，一开始引入的学习率为 0.01。 随着 epoch 的增加，学习率下降为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.01</mn><msqrt><mfrac><mn>1</mn><mrow><mi>e</mi><mi>p</mi><mi>o</mi><mi>c</mi><mi>h</mi></mrow></mfrac></msqrt></mrow><annotation encoding="application/x-tex">0.01\sqrt{\frac{1}{epoch}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.8400000000000003em;vertical-align:-.6729999999999999em"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">1</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1670000000000003em"><span class="svg-align" style="top:-3.8em"><span class="pstrut" style="height:3.8em"></span><span class="mord" style="padding-left:1em"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.845108em"><span style="top:-2.6550000000000002em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">h</span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.481108em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.127em"><span class="pstrut" style="height:3.8em"></span><span class="hide-tail" style="min-width:1.02em;height:1.8800000000000001em"><svg width="400em" height="1.8800000000000001em" viewBox="0 0 400000 1944" preserveAspectRatio="xMinYMin slice"><path d="M983 90
l0 -0
c4,-6.7,10,-10,18,-10 H400000v40
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.6729999999999999em"><span></span></span></span></span></span></span></span></span>。 设置动量为 0.95。</p></li><li><p><strong>Stochastic Gradient Langevin Dynamics(SGLD):</strong><br>SGLD 是一种优化方法，其基本思想是在梯度下降过程中注入噪声。<br>它与随机梯度下降（SGD）类似，只不过它在梯度下降更新参数时结合了噪声</p></li></ul><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>x</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>t</mi></msub><mo>−</mo><mi>L</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo>⋅</mo><mi mathvariant="normal">∇</mi><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msqrt><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>L</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow></msqrt><mo>⋅</mo><msqrt><mrow><mn>2</mn><mo>⋅</mo><mi>T</mi></mrow></msqrt><mo>⋅</mo><mi>w</mi></mrow><annotation encoding="application/x-tex">x_{t+1} = x_t - LearningRate \cdot \nabla f(x) + \sqrt{1/LearningRate} \cdot \sqrt{2 \cdot T} \cdot w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.638891em;vertical-align:-.208331em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.301108em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.208331em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.73333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.2805559999999999em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">n</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">∇</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.24em;vertical-align:-.25612499999999994em"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.983875em"><span class="svg-align" style="top:-3.2em"><span class="pstrut" style="height:3.2em"></span><span class="mord" style="padding-left:1em"><span class="mord">1</span><span class="mord">/</span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">n</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span><span style="top:-2.9438750000000002em"><span class="pstrut" style="height:3.2em"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em"><svg width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.25612499999999994em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-.06445999999999996em"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.9755400000000001em"><span class="svg-align" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord" style="padding-left:.833em"><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span><span style="top:-2.93554em"><span class="pstrut" style="height:3em"></span><span class="hide-tail" style="min-width:.853em;height:1.08em"><svg width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.06445999999999996em"><span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span></span></p><p>其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mi>e</mi><mi>a</mi><mi>r</mi><mi>n</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">LearningRate</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8777699999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">n</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span></span> 表示梯度下降的学习率。 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span></span></span></span> 表示目标函数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.13889em">T</span></span></span></span> 称为温度，通常取值 0.1 或 0.01。 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span> 表示高斯噪声</p><p><strong>初始化和正则化：</strong><br>方差初始化为 Pytorch 的默认设置。除了某些明确的情况外，不存在例如 weight decay 和 dropout 这样的正则化</p><p><strong>Batch Size：</strong><br>Cifar10 的 Batch Size 为 128。Fashion MNIST 的 Batch Size 为 100</p><p 测试准确度=""><strong>训练误差和测试误差：</strong><br>前者等于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mtext mathvariant="italic">训练精度</mtext></mrow><annotation encoding="application/x-tex">1-\textit{训练精度}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord text"><span class="mord textit cjk_fallback">训练精度</span></span></span></span></span>（每个 epoch 之后基于训练集测试模型的性能）。 后者等于 1-\textit</p><h1 id="实验结果"><a class="anchor" href="#实验结果">#</a> 实验结果</h1><h2 id="model-wise-double-descent"><a class="anchor" href="#model-wise-double-descent">#</a> Model-wise Double Descent</h2><p>我们在自己的实验中重现了宽度方向的双下降现象。 与前文提到的在 Cifar10、Cifar100 和 MNIST 数据集上进行的实验不同，我们尝试在 Fashion MNIST 数据集上重现宽度方向双下降图。如下图</p><div align="center"><img data-src="/assets/double_descent/width_double_descent.png" alt="图片1" width="50%" title="经典机器学习中的风险曲线" display="inline"> <span class="image-info">图3 带有 20% 标签噪声的，基于 Fashion MNIST 数据集的Model-wise Double Descent</span></div><h2 id="epoch-wise-double-descent"><a class="anchor" href="#epoch-wise-double-descent">#</a> Epoch-wise Double Descent</h2><p>我们将这些不同大小的模型，根据宽度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span> 不同，分别训练 1000 个 epoch。 根据结果，将这些模型分为四个不同的区域，在 1000 个 epoch 训练中具有不同的测试误差</p><p>每个区域的模型大小的具体图如图所示</p><p>首先，当模型宽度很小时，不会发生过拟合。当模型宽度变大时，过拟合问题会随之出现，并且在某个区域变得越来越严重。在该区域之后，过拟合开始减弱，并在训练结束时，测试误差趋于稳定。 当模型规模确实较大时，过拟合的程度比过拟合峰值前后要小得多，测试误差甚至趋于缓慢下降。</p><figure class="half"><img data-src="/assets/double_descent/w1epoch_double_descent.png" alt="图片1" width="40%" title="Small-model region" display="inline"> <img data-src="/assets/double_descent/w10epoch_double_descent.png" alt="图片2" width="40%" title="Overfitting Worsening region"></figure><figure class="half"><img data-src="/assets/double_descent/w62epoch_double_descent.png" alt="图片3" width="40%" title="Overfitting Alleviating region" display="inline"> <img data-src="/assets/double_descent/w308epoch_double_descent.png" alt="图片4" width="40%" title="Double Descent region"> <span class="image-info">图4 4个不同类型模型尺寸的测试误差</span></figure><p>因此，当用于训练的模型足够大时，随着 epoch 数量的增加，会出现双下降现象。 在我们的实验中，我们使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mn>512</mn></mrow><annotation encoding="application/x-tex">w = 512</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02691em">w</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">5</span><span class="mord">1</span><span class="mord">2</span></span></span></span> 的 2 层 CNN 在 Fashion MNIST 数据集上训练。 CNN 更具体的设置在实验部分展示。 结果如图 \ref {fig:epochdd} 所示。</p><p>epoch 的数量也会影响模型双下降现象的明显程度，如图 \ref {fig:subepochdd} 所示。 此外，这里进行的另一个观察是，当我们增加训练数据的 epoch 数时，双下降图的峰值逐渐向左移动。</p><figure class="half"><img data-src="/assets/double_descent/epoch_double_descent.png" alt="图片3" width="40%" title="Epoch-wise Double Descent with CNN width 512" display="inline"> <img data-src="/assets/double_descent/subepoch_double_descent.png" alt="图片4" width="40%" title="Width-wise Double Descent with different epochs"> <span class="image-info">图5 宽度为 512 的 Fashion MNIST 数据集上的 Epoch-wise Double Descent（左）和不同训练 epoch 后 Fashion MNIST 数据集上的 Width-wise Double Descent（右）</span></figure><h2 id="noise-wise-double-descent"><a class="anchor" href="#noise-wise-double-descent">#</a> Noise-wise Double Descent</h2><p>向数据中添加几种类型的噪声，观察双下降现象。一种类型是标签噪声，它试图将图像的某个部分随机地标记为错误的标签。 当我们去除标签噪声后，双下降现象就不再明显了。 我们再次在 Fashion MNIST 数据集上进行了尝试，如图 \ref {fig:noishedd} 所示。</p><figure class="half"><img data-src="/assets/double_descent/noise_double_descent.png" alt="图片3" width="40%" title="Width-wise Double Descent w/wo label noise" display="inline"> <img data-src="/assets/double_descent/lr_double_descent.png" alt="图片4" width="40%" title="Width-wise Double Descent with decaying or fixed learning rate"> <span class="image-info">图6 无标签噪声的Fashion MNIST 数据集上的双重下降比较（左）和具有衰减和固定学习率的Fashion MNIST 数据集上的双重下降比较（右）</span></figure><h2 id="learning-rate-wise-double-descent"><a class="anchor" href="#learning-rate-wise-double-descent">#</a> Learning-rate-wise Double Descent</h2><p>在之前的实验中，我们使用 SGD 优化器采取了衰减的学习率。 我们还感兴趣这个设置对于我们的双下降现象有多重要。 因此，我们还在所有训练过程中尝试使用固定的学习率值 0.01。结果如图 \ref {fig:lrdd} 所示，这表明如果我们使用固定学习率，双下降在峰值方面会更加明显。 然而，对于第二个下降部分，如果我们使用固定学习率，测试误差不会像学习率衰减一样下降。</p><h1 id="讨论分析"><a class="anchor" href="#讨论分析">#</a> 讨论分析</h1><p>我们在这里试图提出了一个想法来总结上述实验。</p><p>我们的想法是，我们可以使用上述四个不同区域的测试误差曲线的不同行为来解释所有双下降现象及其变化</p><p>回顾一下这四个不同的区域是：</p><ol><li>小模型区域，模型尺寸极小，不会发生过拟合</li><li>过拟合恶化区域，模型比第一区域的模型更大，但随着模型尺寸的增大，过拟合越来越严重；</li><li>过拟合缓解区域，模型尺寸变得更大，但训练足够的 epoch 后过拟合停止；</li><li>双下降区域，该区域模型尺寸极大，过拟合幅度小得多，甚至在达到过拟合峰值后测试误差开始下降</li></ol><p>对于小模型区域的模型，不存在过拟合问题，因此较长 epoch 的训练不会显着影响其预测 tetsing 数据的性能。</p><p>类似地，对于双下降区域的模型，过度拟合会很快减少，因此如果训练 epoch 足够大（例如我们图中的 250 个 epoch），则 epoch 对测试误差没有显着影响</p><p>对于过拟合恶化区域的模型，训练的 epoch 越多，过拟合就越严重，宽度方向双下降曲线的峰值往往会变得更高。</p><p>对于处于过拟合缓解区域的模型，随着模型规模的增大，过拟合的停止点会变早，因此减少训练 epoch 对模型的影响很小。 然而，对于不够大的模型，过拟合在特定数量的 epoch 后不会停止（例如，模型大小 50 时的 250 个 epoch），因此，如果我们训练更长的时间，测试误差仍然会增加</p><p>此外，我们之所以认为去除标签噪声后双下降会减少，是因为双下降现象中最重要的问题是随着模型大小的增加，模型可能会过拟合。 然而，对于 Fashion MNIST 数据集，测试数据集和训练数据集之间不存在显着偏差。 这样即使我们使用过多的参数也不容易发生过拟合。 因此，添加 20% 的标签噪声是引入足够偏差的好方法，在这种情况下更有可能发生过拟合。 当出现过拟合问题时，上述四个区域可以很好地解释双下降现象。</p><p>对于不同学习率方案下双下降曲线略有不同的原因，我们认为这是因为固定的学习率可能会导致更严重的过拟合问题。 因为，双下降曲线的峰值更高，而衰减学习率的测试误差曲线，在平坦且平滑的区域中有更多波动</p><p><img data-src="/assets/double_descent/sample-wise-noise.png" alt="" title="图7 针对不同数据集大小，在 CIFAR-10 上分别使用 0、10%、20% 标签噪声的 5 层 CNN 的模型双下降"></p><h1 id="其他有趣的探索发现"><a class="anchor" href="#其他有趣的探索发现">#</a> 其他有趣的探索发现</h1><p>在这里，演示了几个适合实际应用场景的潜在元素，这些元素可能会影响双下降曲线</p><h2 id="数据集的数量"><a class="anchor" href="#数据集的数量">#</a> 数据集的数量</h2><p>在某些特定情况下，如果我们只是想验证或探索某些现象或模型。 一般会使用简单的模型和小规模数据集建立一个 demo。 这样可以在项目的早期阶段节省时间和资源。 另一方面，如果模型训练的输入样本不是太多，我们就必须尝试用有限的数据完成训练。 因此，此类场景中是否存在双重下降以及其如何变化将是一个值得探索的事情</p><p>与上面的实验类似，通过减少 Cifar10 数据集的数量（训练集从 50,000 到 10,000，测试集从 10,000 到 2,000），我们绘制了不同样本数量下的误差性能曲线</p><p>我们从两个方面进行了实验，如图 \ref {fig:flowchar1} 和图 \ref {fig:flowchar2} 所示。 比较在不同模型复杂度和不同标签噪声的场景下，较少的数据集是否会影响曲线的形状。结论是类似的</p><p><img data-src="/assets/double_descent/sample-wise.png" alt="" title="图8 针对不同数据集大小，在 CIFAR-10 上分别具有 3,5 和 7 层的多个 CNN 的模型双下降"></p><p>一方面，随着数据集样本的减少，过拟合的峰值 “向左移动”，这符合预期。 甚至，在 7 层 CNN 的情况下，过拟合峰值提前得很远，以至于 U 形曲线的前部完全消失。 曲线整体上移，曲线下面积增大。 训练误差下降得更快，训练误差下降到接近 0 的阈值基本上对应于测试误差过拟合达到峰值的阈值。</p><p>另一方面，当网络宽度足够大（模型足够复杂）时，不同样本数量的差异不会太大。 特别是当曲线刚刚通过拟合点时，如图 \ref {fig:flowchar2} 的橙色阴影区域所示，存在一定范围的模型宽度，对于大规模和小规模数据集，结果的测试误差几乎没有差别</p><h2 id="提前停止-early-stopping"><a class="anchor" href="#提前停止-early-stopping">#</a> 提前停止 Early Stopping</h2><p>在机器学习中，早期停止是一种正则化形式，用于避免过度拟合。 这种方法会更新学习器，以便在每次迭代时更好地适应训练数据。 在某种程度上，这提高了模型在训练集之外的数据上的表现。</p><p>在许多机器学习库中，它是一种可调用的回调方法，通过监视某些指标（例如验证集的 error 或 accuracy）来提前保存训练结果权重。</p><p>由于这是避免过度拟合的绝佳策略，因此在实施提前停止时不会出现双下降曲线。 与实际实践不同，模型需要等待几个 “patient” 的 epoch 来决定是否停止；我们直接输出每个宽度训练过程中的最小误差值。 曲线如图 \ref {fig:early} 所示。上方的虚线代表采取早停政策的结果。 最下面是双下降曲线和最优早停曲线的减值。</p><p><img data-src="/assets/double_descent/early_stop.png" alt="" title="图9 实施提前停止后曲线的可视化。上曲线：双下降曲线和最佳提前停止曲线。下曲线：两者的区别。"></p><p>我们比较了具有不同复杂度和不同标签噪声的几种模型，这极大地影响了峰的位置和相对高度。 事实上，提前停止可以平滑过度拟合曲线，从而返回最佳结果。 这符合提前停止可以避免过度拟合的常识。</p><h2 id="特征噪声"><a class="anchor" href="#特征噪声">#</a> 特征噪声</h2><p>我们添加高斯噪声作为 mask 来观察双下降曲线的变化。 以 CIFAR-10 的图像为例，每个样本都是一个 32x32x3 的矩阵（宽 x 高 x 通道），像素值在 0-255 之间</p><p>在图 \ref {fig:Gaussian}(a) 中，我们实现了幅度为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>20</mn></mrow><annotation encoding="application/x-tex">20</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">0</span></span></span></span> 的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N(0,1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 噪声。 每个渠道的变化都不同。 将格式更改为 PIL (uint8) 后，我们将样本归一化为值在 0-1 范围内的矩阵。 右图是原图，左图是变换后的图。</p><figure class="half"><img data-src="/assets/double_descent/Gaussian noise.png" alt="图片1" width="40%" title="Gaussian noise effect drawing. Left: After the transform. Right: Before the transform" display="inline"> <img data-src="/assets/double_descent/Gaussian noise plot.png" alt="图片2" width="40%" title="Model-wise plot of different feature noise with 0% label noise"> <span class="image-info">图10 添加高斯噪声的效果示意图（左）和双下降曲线对比（右）</span></figure><p>如图 \ref {fig:Gaussian}(b) 所示，我们在实验中实现了相同的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">0\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.80556em;vertical-align:-.05556em"></span><span class="mord">0</span><span class="mord">%</span></span></span></span> 噪声。 虽然在没有标签噪声的情况下，双下降的曲线并不明显。 我们仍然可以观察到，添加高斯噪声的操作在一定程度上平滑了双下降峰，尽管虽然整体误差略有上升</p><p>我们可以考虑添加特征噪声作为一种数据增强。 曲线变化的原因可能是因为数据增强增加了模型的泛化能力。 换句话说，它避免了模型的过度拟合。 这样的结果也符合常识</p><h2 id="sgld"><a class="anchor" href="#sgld">#</a> SGLD</h2><p>我们还尝试将之前使用的 SGD 优化器更改为另一个优化器 SGLD，看看在梯度下降步骤中添加一些不确定性后，它是否仍然会导致双下降现象。 该图如图 \ref {fig:SGLDdd} 所示。</p><figure class="half"><img data-src="/assets/double_descent/SGLD_width_double_descent.png" alt="图片1" width="40%" title="Width-wise Double Descent with SGLD" display="inline"> <img data-src="/assets/double_descent/opt_double_descent.png" alt="图片2" width="40%" title="Comparison between SGD and SGLD"> <span class="image-info">图11 带有 20% 标签噪声和 SGLD 优化器的 Fashion MNIST 数据集的宽度双下降（左）以及与 SGD 优化器的比较（右）</span></figure><p>我们仍然可以在 SGLD 优化器下观察到双下降现象，但它看起来与我们从 SGD 优化器获得的双下降图有点不同。 为了更清楚地比较它们，我们将它们放在图 \ref {fig:optdd} 的同一图中</p><p>在此图中，我们可以观察到，将优化器更改为 SGLD 后，图中的第二次下降向右移动了一点。 然而，足够大的模型的测试误差往往会变得相同。 所以总的来说，SGD 更适合用于 Fashion MNIST 数据集，因为测试误差的第二次下降比 SGLD 更早。</p><p>我们尝试使用 SGD 和 SGLD 来分析曲线之间的差异。 从图中我们可以看到，在蓝色上升曲线所示的过拟合状态下，SGLD 的测试误差比 SGD 的测试误差要低一些，尽管并不明显</p><p>我们假设这是因为 SGLD 引入了额外的随机性。 此时模型与测试数据不太吻合，SGLD 引入的额外噪声可以帮助分散全局最小值，从而改变目标函数的格局。 这种行为可以增加找到全局最小值的机会，从而稍微减少测试误差</p><p>当遇到第二次下降时，更复杂的模型变得更适合数据。 随机性变得没那么必要，并且可能会损害模型的性能，因为此时输入的噪声可能覆盖全局最小值。 SGD 和 SGLD 之间的微小差异可能是因为我们在更新参数时在 SGLD 中引入了很少的噪声</p><h1 id="结论"><a class="anchor" href="#结论">#</a> 结论</h1><p>在这个项目中，我们从理论和实践两个方面讨论了双重下降现象。 分析了为什么会出现双下降现象，研究了哪些参数影响双下降现象，分析了结果，得出了一些有趣的结论</p><p>我们的模型复杂度是基于神经网络的宽度，并且我们知道随着模型复杂度的增加，会出现双下降现象，基于这个条件 ，我们将测试不同参数对这种现象的不同影响</p><p><strong>Epoch-wise</strong>：随着 epoch 的增加，双下降现象逐渐变得明显，双下降图的峰值也会向左移动。 造成这种现象的原因是 epoch 越大，过拟合越严重。 较大的模型被放大到一定程度，并在 epoch 增加时停止过拟合。 因此峰值将向左移动</p><p><strong>Label Noise-wise</strong>：双下降现象可以被噪声增强，但是当我们去除噪声后，双下降现象不再明显，最坏的情况下，双下降现象甚至没有出现</p><p><strong>Learning Rate-wise</strong>：本节中，我们尝试固定学习率，看看对双下降现象是否有影响。结果很明显，当我们在所有 epoch 中将学习率固定为 0.01 时，我们可以看到两次下降的峰值比之前高得多，但是对于第二次下降，它不能像以前一样下降</p><p><strong>数据集规模</strong>：在本节中，我们测试了不同数据集规模对这种双下降现象的影响。 实验基于不同层数的 CNN，分别为 3 层、5 层和 7 层，在不同设置下的结果趋于相似。 我们观察到两个主要现象：首先，当我们减小数据集规模时，峰值向左移动，同时，我们可以看到训练误差下降得更快。 其次，测试误差曲线和训练误差曲线均向上移动，并且曲线下面积增大。 原因是更多的数据会增加模型的复杂性，也会损害模型的性能</p><p><strong>Early Stopping</strong>：在本节中，我们保存了每个 epoch 的准确率得分，并直接输出过程中的最小误差值。 我们发现，采用 Early Stopping 方法，双下降曲线趋于平滑，因为 Early Stopping 是一种优化器，避免了过拟合，但没有过拟合，双下降现象就不会出现</p><p>我们还试图找出高斯噪声和 SGLD 对双下降现象的影响。 核心思想是在原始数据和梯度下降过程中注入噪声。我们发现，在原始数据中注入高斯噪声可以稍微平滑双下降。对于 SGLD，我们发现它在过拟合状态下比 SGD 实现了更低的测试误差，并且在过参数化区域时具有更高的测试误差</p><table><thead><tr><th rowspan="2">Dataset</th><th rowspan="2">Arch.</th><th rowspan="2">Opt.</th><th rowspan="2">%Noise</th><th colspan="2">Double-Descent</th><th rowspan="2">Experiment in</th><th rowspan="2">Figure(s)</th></tr><tr><th>in Model</th><th>in Epoch</th></tr></thead><tbody><tr><td>F. MNIST</td><td>2L-CNN</td><td></td><td>20%</td><td>√</td><td></td><td>Width</td><td>5, 6, 7(a)</td></tr><tr><td>F. MNIST</td><td>2L-CNN</td><td></td><td>20%</td><td></td><td>√</td><td>Epoch</td><td>7(a), 7(b)</td></tr><tr><td>F. MNIST</td><td>2L-CNN</td><td></td><td>0%</td><td></td><td></td><td>Noise</td><td>8(a)</td></tr><tr><td rowspan="2">F. MNIST</td><td rowspan="2">5L-CNN</td><td rowspan="2"></td><td rowspan="2">0%</td><td rowspan="2">√</td><td rowspan="2"></td><td>Noise</td><td rowspan="2">11</td></tr><tr><td>Early Stopping</td></tr><tr><td rowspan="2">F. MNIST</td><td rowspan="2">5L-CNN</td><td rowspan="2"></td><td rowspan="2">10%</td><td rowspan="2">√</td><td rowspan="2"></td><td>Noise</td><td rowspan="2">11</td></tr><tr><td>Early Stopping</td></tr><tr><td rowspan="2">F. MNIST</td><td rowspan="2">5L-CNN</td><td rowspan="2"></td><td rowspan="2">20%</td><td rowspan="2">√</td><td rowspan="2"></td><td>Noise</td><td rowspan="2">11</td></tr><tr><td>Early Stopping</td></tr><tr><td>CIFAR-10</td><td>3L-CNN</td><td></td><td>20%</td><td>√</td><td></td><td>Sample Scale</td><td>10</td></tr><tr><td>CIFAR-10</td><td>5L-CNN</td><td></td><td>20%</td><td>√</td><td></td><td>Sample Scale</td><td>10</td></tr><tr><td>CIFAR-10</td><td>7L-CNN</td><td></td><td>20%</td><td>√</td><td></td><td>Sample Scale</td><td>10</td></tr><tr><td>CIFAR-10</td><td>5L-CNN</td><td></td><td>Gaussian</td><td></td><td></td><td>Feature Noise</td><td>12</td></tr><tr><td>F.MNIST</td><td>2L-CNN</td><td>Fixed SGD LR</td><td>20%</td><td>√</td><td></td><td>Learning rate</td><td>8(b)</td></tr><tr><td>F.MNIST</td><td>2L-CNN</td><td>Decay SGD LR</td><td>20%</td><td>√</td><td></td><td>Learning rate</td><td>8(b)</td></tr><tr><td>F.MNIST</td><td>2L-CNN</td><td>SGLD</td><td>20%</td><td>√</td><td></td><td>Optimizer</td><td>13(a), 13(b)</td></tr><tr><td>F.MNIST</td><td>2L-CNN</td><td>SGD</td><td>20%</td><td>√</td><td></td><td>Optimizer</td><td>13(a), 13(b)</td></tr></tbody></table><div class="tags"><a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag"><i class="ic i-tag"></i> 机器学习</a> <a href="/tags/Python/" rel="tag"><i class="ic i-tag"></i> Python</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2024-04-23 23:55:00" itemprop="dateModified" datetime="2024-04-23T23:55:00+08:00">2024-04-23</time> </span><span id="projects/double_descent/" class="item leancloud_visitors" data-flag-title="探究不同场景下的双下降(Double Descent)现象" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.jpg" alt="Miralce 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.jpg" alt="Miralce 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Miralce <i class="ic i-at"><em>@</em></i>自是白衣卿相的博客</li><li class="link"><strong>本文链接：</strong> <a href="http://m1racle.cn/projects/double_descent/" title="探究不同场景下的双下降(Double Descent)现象">http://m1racle.cn/projects/double_descent/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/neural_network/transformer/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;MiracleLinzzz.github.io&#x2F;picx-images-hosting&#x2F;DSCF8835.62opfc0lrwg0.webp" title="Transformer 备忘录"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 神经网络</span><h3>Transformer 备忘录</h3></a></div><div class="item right"><a href="/projects/stream_processing/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;miraclelinzzz.github.io&#x2F;assets&#x2F;cover&#x2F;stream.jpg" title="用深度强化学习实时预测和交易加密货币"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 科研项目</span><h3>用深度强化学习实时预测和交易加密货币</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">背景介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%8F%8C%E4%B8%8B%E9%99%8D%E4%BC%9A%E5%8F%91%E7%94%9F"><span class="toc-number">2.</span> <span class="toc-text">为什么双下降会发生</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%9B%E5%8C%96%E8%AF%AF%E5%B7%AE%E7%9A%84%E5%88%86%E8%A7%A3"><span class="toc-number">2.1.</span> <span class="toc-text">泛化误差的分解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%81%8F%E5%B7%AE-%E6%96%B9%E5%B7%AE%E6%9B%B2%E7%BA%BF"><span class="toc-number">2.2.</span> <span class="toc-text">偏差 - 方差曲线</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C"><span class="toc-number">3.</span> <span class="toc-text">实验</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E8%AE%BE%E7%BD%AE"><span class="toc-number">3.1.</span> <span class="toc-text">实验设置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.1.</span> <span class="toc-text">损失函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B"><span class="toc-number">3.1.2.</span> <span class="toc-text">模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%AD%E7%BB%83%E7%BB%86%E8%8A%82%E5%92%8C%E8%B6%85%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.3.</span> <span class="toc-text">训练细节和超参数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">4.</span> <span class="toc-text">实验结果</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#model-wise-double-descent"><span class="toc-number">4.1.</span> <span class="toc-text">Model-wise Double Descent</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#epoch-wise-double-descent"><span class="toc-number">4.2.</span> <span class="toc-text">Epoch-wise Double Descent</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#noise-wise-double-descent"><span class="toc-number">4.3.</span> <span class="toc-text">Noise-wise Double Descent</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#learning-rate-wise-double-descent"><span class="toc-number">4.4.</span> <span class="toc-text">Learning-rate-wise Double Descent</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%A8%E8%AE%BA%E5%88%86%E6%9E%90"><span class="toc-number">5.</span> <span class="toc-text">讨论分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%9C%89%E8%B6%A3%E7%9A%84%E6%8E%A2%E7%B4%A2%E5%8F%91%E7%8E%B0"><span class="toc-number">6.</span> <span class="toc-text">其他有趣的探索发现</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E7%9A%84%E6%95%B0%E9%87%8F"><span class="toc-number">6.1.</span> <span class="toc-text">数据集的数量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E5%89%8D%E5%81%9C%E6%AD%A2-early-stopping"><span class="toc-number">6.2.</span> <span class="toc-text">提前停止 Early Stopping</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E5%99%AA%E5%A3%B0"><span class="toc-number">6.3.</span> <span class="toc-text">特征噪声</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sgld"><span class="toc-number">6.4.</span> <span class="toc-text">SGLD</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-number">7.</span> <span class="toc-text">结论</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/projects/stream_processing/" rel="bookmark" title="用深度强化学习实时预测和交易加密货币">用深度强化学习实时预测和交易加密货币</a></li><li class="active"><a href="/projects/double_descent/" rel="bookmark" title="探究不同场景下的双下降(Double Descent)现象">探究不同场景下的双下降(Double Descent)现象</a></li><li><a href="/projects/punch_go/" rel="bookmark" title="基于以太坊的『Punch Go』去中心化应用(DAPP)">基于以太坊的『Punch Go』去中心化应用(DAPP)</a></li><li><a href="/projects/alzheimer/" rel="bookmark" title="Alzheimer’s Disease Detection using Disfluencies Implemented Fine-Tuning BERT Model Ensemble">Alzheimer’s Disease Detection using Disfluencies Implemented Fine-Tuning BERT Model Ensemble</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Miralce" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Miralce</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">8</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">4</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">12</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL01pcmFjbGVMaW56eno=" title="https:&#x2F;&#x2F;github.com&#x2F;MiracleLinzzz"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnl1bmhhbmcubGluQGNvbHVtYmlhLmVkdQ==" title="mailto:yunhang.lin@columbia.edu"><i class="ic i-envelope"></i></span> <span class="exturl item linkedin" data-url="aHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2luL3l1bmhhbmdsaW4v" title="https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;yunhanglin&#x2F;"><i class="ic i-linkedin"></i></span> <span class="exturl item bilibili" data-url="aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vMjg3MDU1OTcz" title="https:&#x2F;&#x2F;space.bilibili.com&#x2F;287055973"><i class="ic i-bilibili"></i></span> <span class="exturl item youtube" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vQHl1bmhhbmdsaW4xNzc4" title="https:&#x2F;&#x2F;www.youtube.com&#x2F;@yunhanglin1778"><i class="ic i-youtube"></i></span> <span class="exturl item xiaohongshu" data-url="aHR0cHM6Ly93d3cueGlhb2hvbmdzaHUuY29tL3VzZXIvcHJvZmlsZS81YmI4NTg0ZjQ1YzZlODAwMDFmMDhiNjc=" title="https:&#x2F;&#x2F;www.xiaohongshu.com&#x2F;user&#x2F;profile&#x2F;5bb8584f45c6e80001f08b67"><i class="ic i-xiaohongshu"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>文章</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/neural_network/transformer/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/projects/stream_processing/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/travel/" title="分类于 旅行日志">旅行日志</a> <i class="ic i-angle-right"></i> <a href="/categories/travel/%E6%97%A5%E6%9C%AC%E8%B7%A8%E5%B9%B4%E8%A1%8C/" title="分类于 日本跨年行">日本跨年行</a></div><span><a href="/travel/japan/food/" title="日本行美食总结">日本行美食总结</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/projects/" title="分类于 科研项目">科研项目</a></div><span><a href="/projects/punch_go/" title="基于以太坊的『Punch Go』去中心化应用(DAPP)">基于以太坊的『Punch Go』去中心化应用(DAPP)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/projects/" title="分类于 科研项目">科研项目</a></div><span><a href="/projects/alzheimer/" title="Alzheimer’s Disease Detection using Disfluencies Implemented Fine-Tuning BERT Model Ensemble">Alzheimer’s Disease Detection using Disfluencies Implemented Fine-Tuning BERT Model Ensemble</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/projects/" title="分类于 科研项目">科研项目</a></div><span><a href="/projects/stream_processing/" title="用深度强化学习实时预测和交易加密货币">用深度强化学习实时预测和交易加密货币</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/travel/" title="分类于 旅行日志">旅行日志</a> <i class="ic i-angle-right"></i> <a href="/categories/travel/%E6%97%A5%E6%9C%AC%E8%B7%A8%E5%B9%B4%E8%A1%8C/" title="分类于 日本跨年行">日本跨年行</a></div><span><a href="/travel/japan/route/" title="15天9城特种兵行程总结">15天9城特种兵行程总结</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/travel/" title="分类于 旅行日志">旅行日志</a></div><span><a href="/travel/xinjiang/xinjiang/" title="跨越山海|新疆自驾毕业旅行">跨越山海|新疆自驾毕业旅行</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/neural-network/" title="分类于 神经网络">神经网络</a></div><span><a href="/neural_network/transformer/" title="Transformer 备忘录">Transformer 备忘录</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/projects/" title="分类于 科研项目">科研项目</a></div><span><a href="/projects/double_descent/" title="探究不同场景下的双下降(Double Descent)现象">探究不同场景下的双下降(Double Descent)现象</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2023 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-Miracle"></i> </span><span class="author" itemprop="copyrightHolder">Miralce @ Miracle</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">30k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">28 分钟</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"projects/double_descent/",favicon:{show:"不亦说乎",hide:"君需记"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>